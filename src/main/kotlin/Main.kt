package org.example

import com.amazonaws.services.lambda.runtime.Context
import com.amazonaws.services.lambda.runtime.RequestHandler
import kotlinx.serialization.Serializable
import kotlinx.serialization.json.Json
import okhttp3.OkHttpClient
import okhttp3.Request
import org.apache.kafka.clients.producer.KafkaProducer
import org.apache.kafka.clients.producer.ProducerConfig
import org.apache.kafka.clients.producer.ProducerRecord
import org.apache.kafka.common.serialization.StringSerializer
import java.io.IOException
import java.util.*
import kotlinx.serialization.encodeToString
import java.text.SimpleDateFormat


@Serializable
data class Identifier(val type: String, val value: String)
@Serializable
data class Cvss(val vector_string: String?, val score: Float?)
@Serializable
data class Cwes(val cwe_id: String, val name: String)
@Serializable
data class Package(val ecosystem: String, val name: String)
@Serializable
data class Vulnerability(val `package`: Package, val vulnerable_version_range: String, val first_patched_version: String?, val vulnerable_functions: Array<String>)
@Serializable
data class GitHubAdvisory(
    val ghsa_id: String,
    val cve_id: String?,
    val url: String,
    val html_url: String,
    val repository_advisory_url: String? = null,
    val summary: String,
    val description: String,
    val type: String,
    val severity: String,
    val source_code_location: String,
    val identifiers: Array<Identifier>,
    val references: Array<String>,
    val published_at: String,
    val updated_at: String,
    val github_reviewed_at: String,
    val nvd_published_at: String?,
    val withdrawn_at: String?,
    val vulnerabilities: Array<Vulnerability>,
    val cvss: Cvss,
    val cwes: Array<Cwes>,
)

fun main() {
    println("Hello World!")
    val str = """
    [
    {"ghsa_id":"GHSA-vx24-x4mv-vwr5","cve_id":"CVE-2024-41815","url":"https://api.github.com/advisories/GHSA-vx24-x4mv-vwr5","html_url":"https://github.com/advisories/GHSA-vx24-x4mv-vwr5","summary":"Starship vulnerable to shell injection via undocumented, unpredictable shell expansion in custom commands","description":"## Description \nStarship is a cross-shell prompt. Starting in version 1.0.0 and prior to version 1.20.0, undocumented and unpredictable shell expansion and/or quoting rules make it easily to accidentally cause shell injection when using custom commands with starship in bash. Version 1.20.0 fixes the vulnerability.\n\n### PoC\nHave some custom command which prints out information from a potentially untrusted/unverified source.\n```\n[custom.git_commit_name]\ncommand = 'git show -s --format=\"%<(25,mtrunc)%s\"'\nstyle = \"italic\"\nwhen = true\n```\n\n### Impact\nThis issue only affects users with custom commands, so the scope is limited, and without knowledge of others' commands, it could be hard to successfully target someone. ","type":"reviewed","severity":"high","`repository_advisory_url`":"https://api.github.com/repos/starship/starship/security-advisories/GHSA-vx24-x4mv-vwr5","source_code_location":"https://github.com/starship/starship","identifiers":[{"value":"GHSA-vx24-x4mv-vwr5","type":"GHSA"},{"value":"CVE-2024-41815","type":"CVE"}],"references":["https://github.com/starship/starship/security/advisories/GHSA-vx24-x4mv-vwr5","https://github.com/starship/starship/commit/cfc58161e0ec595db90af686ad77a73df6d44d74","https://github.com/starship/starship/releases/tag/v1.20.0","https://nvd.nist.gov/vuln/detail/CVE-2024-41815","https://github.com/advisories/GHSA-vx24-x4mv-vwr5"],"published_at":"2024-07-26T21:24:18Z","updated_at":"2024-07-26T21:48:45Z","github_reviewed_at":"2024-07-26T21:24:18Z","nvd_published_at":"2024-07-26T21:15:14Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"rust","name":"starship"},"vulnerable_version_range":">= 1.0.0, <= 1.19.0","first_patched_version":"1.20.0","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H","score":7.4},"cwes":[{"cwe_id":"CWE-77","name":"Improper Neutralization of Special Elements used in a Command ('Command Injection')"}],"credits":[{"user":{"login":"evanbattaglia","id":669236,"node_id":"MDQ6VXNlcjY2OTIzNg==","avatar_url":"https://avatars.githubusercontent.com/u/669236?v=4","gravatar_id":"","url":"https://api.github.com/users/evanbattaglia","html_url":"https://github.com/evanbattaglia","followers_url":"https://api.github.com/users/evanbattaglia/followers","following_url":"https://api.github.com/users/evanbattaglia/following{/other_user}","gists_url":"https://api.github.com/users/evanbattaglia/gists{/gist_id}","starred_url":"https://api.github.com/users/evanbattaglia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/evanbattaglia/subscriptions","organizations_url":"https://api.github.com/users/evanbattaglia/orgs","repos_url":"https://api.github.com/users/evanbattaglia/repos","events_url":"https://api.github.com/users/evanbattaglia/events{/privacy}","received_events_url":"https://api.github.com/users/evanbattaglia/received_events","type":"User","site_admin":false},"type":"reporter"}]},{"ghsa_id":"GHSA-66fw-43h8-f8p3","cve_id":null,"url":"https://api.github.com/advisories/GHSA-66fw-43h8-f8p3","html_url":"https://github.com/advisories/GHSA-66fw-43h8-f8p3","summary":"XMP Toolkit's `XmpFile::close` can trigger undefined behavior","description":"Affected versions of the crate failed to catch C++ exceptions raised within the `XmpFile::close` function. If such an exception occured, it would trigger undefined behavior, typically a process abort.\n\nThis is best demonstrated in [issue #230](https://github.com/adobe/xmp-toolkit-rs/issues/230), where a race condition causes the `close` call to fail due to file I/O errors.\n\nThis was fixed in [PR #232](https://github.com/adobe/xmp-toolkit-rs/pull/232) (released as crate version 1.9.0), which now safely handles the exception.\n\nFor backward compatibility, the existing API ignores the error. A new API `XmpFile::try_close` was added to allow callers to receive and process the error result.\n\nUsers of all prior versions of `xmp_toolkit` are encouraged to update to version 1.9.0 to avoid undefined behavior.\n","type":"reviewed","severity":"low","repository_advisory_url":null,"source_code_location":"https://github.com/adobe/xmp-toolkit-rs","identifiers":[{"value":"GHSA-66fw-43h8-f8p3","type":"GHSA"}],"references":["https://github.com/adobe/xmp-toolkit-rs/issues/230","https://github.com/adobe/xmp-toolkit-rs/issues/233","https://github.com/adobe/xmp-toolkit-rs/pull/232","https://rustsec.org/advisories/RUSTSEC-2024-0360.html","https://github.com/advisories/GHSA-66fw-43h8-f8p3"],"published_at":"2024-07-26T21:14:54Z","updated_at":"2024-07-26T21:14:55Z","github_reviewed_at":"2024-07-26T21:14:54Z","nvd_published_at":null,"withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"rust","name":"xmp_toolkit"},"vulnerable_version_range":"< 1.9.0","first_patched_version":"1.9.0","vulnerable_functions":[]}],"cvss":{"vector_string":null,"score":null},"cwes":[{"cwe_id":"CWE-754","name":"Improper Check for Unusual or Exceptional Conditions"}],"credits":[]},{"ghsa_id":"GHSA-296q-rj83-g9rq","cve_id":null,"url":"https://api.github.com/advisories/GHSA-296q-rj83-g9rq","html_url":"https://github.com/advisories/GHSA-296q-rj83-g9rq","summary":"Reflected Cross Site-Scripting (XSS) in Oveleon Cookiebar","description":"## usd-2024-0009 | Reflected XSS in Oveleon Cookiebar\n\n### Details\n**Advisory ID**: usd-2024-0009 \n**Product**: Cookiebar   \n**Affected Version**: 2.X  \n**Vulnerability Type**: CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')   \n**Security Risk**: HIGH, CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:A/VC:N/VI:L/VA:N/SC:L/SI:L/SA:N   \n**Vendor URL**: https://www.usd.de/    \n**CVE Number**: Not requested yet    \n**CVE Link**: Not requested yet    \n\n### Affected Component\n\nThe `block` function in `CookiebarController.php`.\n\n### Desciption\n\nOveleon's Cookiebar is an extension for the popular Contao CMS.\nThe `block/locale` endpoint does not properly sanitize the user-controlled `locale` input before including it in the backend's HTTP response, thereby causing reflected XSS.\n\n### Fix\nSanitize the `locale` input to prevent XSS payloads from being executed in a user's browser.\n\n### Timeline\n* **2024-04-24**: Vulnerability discovered by Daniel Ruppel of usd AG.\n\n* **2024-07-25**: Probable cause of the vulnerability has been identified as Oveleon's Cookiebar Extension for Contao CMS.\n\n* **2024-07-25**: Vulnerability disclosed via GitHub Vulnerability Report.\n","type":"reviewed","severity":"medium","repository_advisory_url":"https://api.github.com/repos/oveleon/contao-cookiebar/security-advisories/GHSA-296q-rj83-g9rq","source_code_location":"https://github.com/oveleon/contao-cookiebar","identifiers":[{"value":"GHSA-296q-rj83-g9rq","type":"GHSA"}],"references":["https://github.com/oveleon/contao-cookiebar/security/advisories/GHSA-296q-rj83-g9rq","https://github.com/oveleon/contao-cookiebar/commit/1d57470be5878f66d5e1e23f624dd387564b9b8d","https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html","https://github.com/oveleon/contao-cookiebar/blob/2.x/src/Controller/CookiebarController.php","https://github.com/advisories/GHSA-296q-rj83-g9rq"],"published_at":"2024-07-26T14:28:26Z","updated_at":"2024-07-26T14:28:29Z","github_reviewed_at":"2024-07-26T14:28:26Z","nvd_published_at":null,"withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"composer","name":"oveleon/contao-cookiebar"},"vulnerable_version_range":"< 1.16.3","first_patched_version":"1.16.3","vulnerable_functions":[]},{"package":{"ecosystem":"composer","name":"oveleon/contao-cookiebar"},"vulnerable_version_range":">= 2.0.0, < 2.1.3","first_patched_version":"2.1.3","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N","score":6.1},"cwes":[{"cwe_id":"CWE-79","name":"Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"}],"credits":[{"user":{"login":"usdResponsibleDisclosure","id":51906815,"node_id":"MDQ6VXNlcjUxOTA2ODE1","avatar_url":"https://avatars.githubusercontent.com/u/51906815?v=4","gravatar_id":"","url":"https://api.github.com/users/usdResponsibleDisclosure","html_url":"https://github.com/usdResponsibleDisclosure","followers_url":"https://api.github.com/users/usdResponsibleDisclosure/followers","following_url":"https://api.github.com/users/usdResponsibleDisclosure/following{/other_user}","gists_url":"https://api.github.com/users/usdResponsibleDisclosure/gists{/gist_id}","starred_url":"https://api.github.com/users/usdResponsibleDisclosure/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/usdResponsibleDisclosure/subscriptions","organizations_url":"https://api.github.com/users/usdResponsibleDisclosure/orgs","repos_url":"https://api.github.com/users/usdResponsibleDisclosure/repos","events_url":"https://api.github.com/users/usdResponsibleDisclosure/events{/privacy}","received_events_url":"https://api.github.com/users/usdResponsibleDisclosure/received_events","type":"User","site_admin":false},"type":"reporter"}]},{"ghsa_id":"GHSA-2hjr-vmf3-xwvp","cve_id":"CVE-2023-49921","url":"https://api.github.com/advisories/GHSA-2hjr-vmf3-xwvp","html_url":"https://github.com/advisories/GHSA-2hjr-vmf3-xwvp","summary":"Elasticsearch Insertion of Sensitive Information into Log File","description":"An issue was discovered by Elastic whereby Watcher search input logged the search query results on DEBUG log level. This could lead to raw contents of documents stored in Elasticsearch to be printed in logs. Elastic has released 8.11.2 and 7.17.16 that resolves this issue by removing this excessive logging. This issue only affects users that use Watcher and have a Watch defined that uses the search input and additionally have set the search input’s logger to DEBUG or finer, for example using: org.elasticsearch.xpack.watcher.input.search, org.elasticsearch.xpack.watcher.input, org.elasticsearch.xpack.watcher, or wider, since the loggers are hierarchical.","type":"reviewed","severity":"medium","repository_advisory_url":null,"source_code_location":"https://github.com/elastic/elasticsearch","identifiers":[{"value":"GHSA-2hjr-vmf3-xwvp","type":"GHSA"},{"value":"CVE-2023-49921","type":"CVE"}],"references":["https://nvd.nist.gov/vuln/detail/CVE-2023-49921","https://discuss.elastic.co/t/elasticsearch-8-11-2-7-17-16-security-update-esa-2023-29/349179","https://github.com/advisories/GHSA-2hjr-vmf3-xwvp"],"published_at":"2024-07-26T06:30:47Z","updated_at":"2024-07-26T14:18:08Z","github_reviewed_at":"2024-07-26T14:18:08Z","nvd_published_at":"2024-07-26T05:15:10Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"maven","name":"org.elasticsearch:elasticsearch"},"vulnerable_version_range":"< 7.17.16","first_patched_version":"7.17.16","vulnerable_functions":[]},{"package":{"ecosystem":"maven","name":"org.elasticsearch:elasticsearch"},"vulnerable_version_range":">= 8.0.0, < 8.11.2","first_patched_version":"8.11.2","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:A/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N","score":5.2},"cwes":[{"cwe_id":"CWE-532","name":"Insertion of Sensitive Information into Log File"}],"credits":[]},{"ghsa_id":"GHSA-69p6-gp5x-j269","cve_id":"CVE-2024-29069","url":"https://api.github.com/advisories/GHSA-69p6-gp5x-j269","html_url":"https://github.com/advisories/GHSA-69p6-gp5x-j269","summary":"snapd failed to properly check the destination of symbolic links when extracting a snap","description":"In snapd versions prior to 2.62, snapd failed to properly check the destination of symbolic links when extracting a snap. The snap format is a squashfs file-system image and so can contain symbolic links and other file types. Various file entries within the snap squashfs image (such as icons and desktop files etc) are directly read by snapd when it is extracted. An attacker who could convince a user to install a malicious snap which contained symbolic links at these paths could then cause snapd to write out the contents of the symbolic link destination into a world-readable directory. This in-turn could allow an unprivileged user to gain access to privileged information.","type":"reviewed","severity":"medium","repository_advisory_url":null,"source_code_location":"https://github.com/snapcore/snapd","identifiers":[{"value":"GHSA-69p6-gp5x-j269","type":"GHSA"},{"value":"CVE-2024-29069","type":"CVE"}],"references":["https://nvd.nist.gov/vuln/detail/CVE-2024-29069","https://github.com/snapcore/snapd/pull/13682","https://github.com/snapcore/snapd/commit/b66fee81606a1c05f965a876ccbaf44174194063","https://github.com/advisories/GHSA-69p6-gp5x-j269"],"published_at":"2024-07-25T21:31:20Z","updated_at":"2024-07-26T16:39:57Z","github_reviewed_at":"2024-07-26T16:39:29Z","nvd_published_at":"2024-07-25T20:15:04Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"go","name":"github.com/snapcore/snapd"},"vulnerable_version_range":"< 2.62","first_patched_version":"2.62","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:L","score":4.8},"cwes":[{"cwe_id":"CWE-610","name":"Externally Controlled Reference to a Resource in Another Sphere"}],"credits":[]},{"ghsa_id":"GHSA-64jh-cjwc-w8q6","cve_id":"CVE-2024-29068","url":"https://api.github.com/advisories/GHSA-64jh-cjwc-w8q6","html_url":"https://github.com/advisories/GHSA-64jh-cjwc-w8q6","summary":"snapd failed to properly check the file type when extracting a snap","description":"In snapd versions prior to 2.62, snapd failed to properly check the file type when extracting a snap. The snap format is a squashfs file-system image and so can contain files that are non-regular files (such as pipes or sockets etc). Various file entries within the snap squashfs image (such as icons etc) are directly read by snapd when it is extracted. An attacker who could convince a user to install a malicious snap which contained non-regular files at these paths could then cause snapd to block indefinitely trying to read from such files and cause a denial of service.","type":"reviewed","severity":"medium","repository_advisory_url":null,"source_code_location":"https://github.com/snapcore/snapd","identifiers":[{"value":"GHSA-64jh-cjwc-w8q6","type":"GHSA"},{"value":"CVE-2024-29068","type":"CVE"}],"references":["https://nvd.nist.gov/vuln/detail/CVE-2024-29068","https://github.com/snapcore/snapd/pull/13682","https://github.com/snapcore/snapd/commit/b66fee81606a1c05f965a876ccbaf44174194063","https://github.com/advisories/GHSA-64jh-cjwc-w8q6"],"published_at":"2024-07-25T21:31:20Z","updated_at":"2024-07-26T21:32:59Z","github_reviewed_at":"2024-07-26T21:32:48Z","nvd_published_at":"2024-07-25T20:15:04Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"go","name":"github.com/snapcore/snapd"},"vulnerable_version_range":"< 2.62","first_patched_version":"2.62","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:U/C:H/I:N/A:H","score":5.8},"cwes":[{"cwe_id":"CWE-20","name":"Improper Input Validation"}],"credits":[]},{"ghsa_id":"GHSA-4mh8-9689-38vr","cve_id":"CVE-2024-1724","url":"https://api.github.com/advisories/GHSA-4mh8-9689-38vr","html_url":"https://github.com/advisories/GHSA-4mh8-9689-38vr","summary":"snapd failed to restrict writes to the HOME/bin path","description":"In snapd versions prior to 2.62, when using AppArmor for enforcement of sandbox permissions, snapd failed to restrict writes to the HOME/bin path. In Ubuntu, when this path exists, it is automatically added to the users PATH. An attacker who could convince a user to install a malicious snap which used the 'home' plug could use this vulnerability to install arbitrary scripts into the users PATH which may then be run by the user outside of the expected snap sandbox and hence allow them to escape confinement.","type":"reviewed","severity":"medium","repository_advisory_url":null,"source_code_location":"https://github.com/snapcore/snapd","identifiers":[{"value":"GHSA-4mh8-9689-38vr","type":"GHSA"},{"value":"CVE-2024-1724","type":"CVE"}],"references":["https://nvd.nist.gov/vuln/detail/CVE-2024-1724","https://github.com/snapcore/snapd/pull/13689","https://github.com/snapcore/snapd/commit/aa191f97713de8dc3ce3ac818539f0b976eb8ef6","https://gld.mcphail.uk/posts/explaining-cve-2024-1724","https://github.com/advisories/GHSA-4mh8-9689-38vr"],"published_at":"2024-07-25T21:31:20Z","updated_at":"2024-07-26T21:34:23Z","github_reviewed_at":"2024-07-26T21:34:22Z","nvd_published_at":"2024-07-25T19:15:09Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"go","name":"github.com/snapcore/snapd"},"vulnerable_version_range":"< 2.62","first_patched_version":"2.62","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L","score":6.3},"cwes":[{"cwe_id":"CWE-732","name":"Incorrect Permission Assignment for Critical Resource"}],"credits":[]},{"ghsa_id":"GHSA-wmx7-pw49-88jx","cve_id":"CVE-2024-41800","url":"https://api.github.com/advisories/GHSA-wmx7-pw49-88jx","html_url":"https://github.com/advisories/GHSA-wmx7-pw49-88jx","summary":"Craft CMS Allows TOTP Token To Stay Valid After Use","description":"Craft CMS 5 allows reuse of TOTP tokens multiple times within the validity period.\n\n### Impact\n\nAn attacker is able to re-submit a valid TOTP token to establish an authenticated session. This requires that the attacker has knowledge of the victim's credentials.\n\nA TOTP token can be used multiple times to establish an authenticated session.\n[RFC 6238](https://www.rfc-editor.org/rfc/rfc6238) insists that an OTP must not be used more than once.\n\n> The verifier MUST NOT accept the second attempt of the OTP after the successful validation has been issued for the first OTP, which ensures one-time only use of an OTP.\n\nThe OWASP Application Security Verification Standard v4.0.3 (ASVS) [reiterates\nthis property with requirement 2.8.4](https://github.com/OWASP/ASVS/blob/v4.0.3/4.0/en/0x11-V2-Authentication.md#v28-one-time-verifier).\n\n> Verify that time-based OTP can be used only once within the validity period.\n\nIt should also be noted that the validity period of an TOTP token is 2 minutes. This makes a successful brute force attack more likely, since the four tokens are valid at the same time.\n\n### Patches\n\nThis has been patched in Craft 5.2.3.\n\nReferences:\n\nhttps://github.com/sbaresearch/advisories/tree/public/2024/SBA-ADV 2024061701_CraftCMS_TOTP_Valid_After_Use\n\nhttps://github.com/craftcms/cms/releases/tag/5.2.3","type":"reviewed","severity":"medium","repository_advisory_url":"https://api.github.com/repos/craftcms/cms/security-advisories/GHSA-wmx7-pw49-88jx","source_code_location":"https://github.com/craftcms/cms","identifiers":[{"value":"GHSA-wmx7-pw49-88jx","type":"GHSA"},{"value":"CVE-2024-41800","type":"CVE"}],"references":["https://github.com/craftcms/cms/security/advisories/GHSA-wmx7-pw49-88jx","https://github.com/craftcms/cms/commit/7c790fa5ad5a8cb8016cb6793ec3554c4c079e38","https://github.com/sbaresearch/advisories/tree/public/2024/SBA-ADV-20240617-01_CraftCMS_TOTP_Valid_After_Use","https://nvd.nist.gov/vuln/detail/CVE-2024-41800","https://github.com/craftcms/cms/releases/tag/5.2.3","https://github.com/advisories/GHSA-wmx7-pw49-88jx"],"published_at":"2024-07-25T17:58:01Z","updated_at":"2024-07-26T21:40:28Z","github_reviewed_at":"2024-07-25T17:58:01Z","nvd_published_at":"2024-07-25T17:15:11Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"composer","name":"craftcms/cms"},"vulnerable_version_range":">= 5.0.0-beta.1, <= 5.2.2","first_patched_version":"5.2.3","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:N/I:H/A:N","score":4.8},"cwes":[{"cwe_id":"CWE-287","name":"Improper Authentication"}],"credits":[{"user":{"login":"FabianTUW","id":92648245,"node_id":"U_kgDOBYWzNQ","avatar_url":"https://avatars.githubusercontent.com/u/92648245?v=4","gravatar_id":"","url":"https://api.github.com/users/FabianTUW","html_url":"https://github.com/FabianTUW","followers_url":"https://api.github.com/users/FabianTUW/followers","following_url":"https://api.github.com/users/FabianTUW/following{/other_user}","gists_url":"https://api.github.com/users/FabianTUW/gists{/gist_id}","starred_url":"https://api.github.com/users/FabianTUW/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FabianTUW/subscriptions","organizations_url":"https://api.github.com/users/FabianTUW/orgs","repos_url":"https://api.github.com/users/FabianTUW/repos","events_url":"https://api.github.com/users/FabianTUW/events{/privacy}","received_events_url":"https://api.github.com/users/FabianTUW/received_events","type":"User","site_admin":false},"type":"reporter"}]},{"ghsa_id":"GHSA-cx7h-h87r-jpgr","cve_id":null,"url":"https://api.github.com/advisories/GHSA-cx7h-h87r-jpgr","html_url":"https://github.com/advisories/GHSA-cx7h-h87r-jpgr","summary":"The kstring integration in gix-attributes is unsound","description":"`gix-attributes` (in [`state::ValueRef`](https://github.com/Byron/gitoxide/blob/gix-attributes-v0.22.2/gix-attributes/src/state.rs#L19-L27)) unsafely creates a `&str` from a `&[u8]` containing non-UTF8 data, with the justification that so long as nothing reads the `&str` and relies on it being UTF-8 in the `&str`, there is no UB:\n\n```rust\n// SAFETY: our API makes accessing that value as `str` impossible, so illformed UTF8 is never exposed as such.\n```\n\nThe problem is that the non-UTF8 `str` **is** exposed to outside code: first to the `kstring` crate itself, which requires UTF-8 in its documentation and may have UB as a consequence of this, but also to `serde`, where it propagates to e.g. `serde_json`, `serde_yaml`, etc., where the same problems occur.\n\nThis is not sound, and it could cause further UB down the line in these places that can view the `&str`.\n","type":"reviewed","severity":"low","repository_advisory_url":null,"source_code_location":"https://github.com/Byron/gitoxide","identifiers":[{"value":"GHSA-cx7h-h87r-jpgr","type":"GHSA"}],"references":["https://github.com/Byron/gitoxide/issues/1460","https://github.com/rustsec/advisory-db/commit/884aaa1646132bc3a27ba058197d6ef039bec294","https://rustsec.org/advisories/RUSTSEC-2024-0359.html","https://github.com/advisories/GHSA-cx7h-h87r-jpgr"],"published_at":"2024-07-25T16:38:42Z","updated_at":"2024-07-25T16:38:42Z","github_reviewed_at":"2024-07-25T16:38:42Z","nvd_published_at":null,"withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"rust","name":"gix-attributes"},"vulnerable_version_range":"< 0.22.3","first_patched_version":"0.22.3","vulnerable_functions":[]}],"cvss":{"vector_string":null,"score":null},"cwes":[{"cwe_id":"CWE-172","name":"Encoding Error"}],"credits":[]},{"ghsa_id":"GHSA-7726-43hg-m23v","cve_id":"CVE-2024-41667","url":"https://api.github.com/advisories/GHSA-7726-43hg-m23v","html_url":"https://github.com/advisories/GHSA-7726-43hg-m23v","summary":"OpenAM FreeMarker template injection","description":"OpenAM is an open access management solution. In versions 15.0.3 and prior, the `getCustomLoginUrlTemplate` method in RealmOAuth2ProviderSettings.java is vulnerable to template injection due to its usage of user input. Although the developer intended to implement a custom URL for handling login to override the default PingOne Advanced Identity Cloud login page,they did not restrict the `CustomLoginUrlTemplate`, allowing it to be set freely. Commit fcb8432aa77d5b2e147624fe954cb150c568e0b8 introduces `TemplateClassResolver.SAFER_RESOLVER` to disable the resolution of commonly exploited classes in FreeMarker template injection. As of time of publication, this fix is expected to be part of version 15.0.4.","type":"reviewed","severity":"high","repository_advisory_url":"https://api.github.com/repos/OpenIdentityPlatform/OpenAM/security-advisories/GHSA-7726-43hg-m23v","source_code_location":"https://github.com/OpenIdentityPlatform/OpenAM","identifiers":[{"value":"GHSA-7726-43hg-m23v","type":"GHSA"},{"value":"CVE-2024-41667","type":"CVE"}],"references":["https://github.com/OpenIdentityPlatform/OpenAM/security/advisories/GHSA-7726-43hg-m23v","https://nvd.nist.gov/vuln/detail/CVE-2024-41667","https://github.com/OpenIdentityPlatform/OpenAM/commit/fcb8432aa77d5b2e147624fe954cb150c568e0b8","https://github.com/advisories/GHSA-7726-43hg-m23v"],"published_at":"2024-07-25T14:15:32Z","updated_at":"2024-07-25T14:15:33Z","github_reviewed_at":"2024-07-25T14:15:32Z","nvd_published_at":"2024-07-24T18:15:05Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"maven","name":"org.openidentityplatform.openam:openam-oauth2"},"vulnerable_version_range":"<= 15.0.3","first_patched_version":"15.0.4","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H","score":8.8},"cwes":[{"cwe_id":"CWE-94","name":"Improper Control of Generation of Code ('Code Injection')"}],"credits":[{"user":{"login":"AfterSnows","id":93036180,"node_id":"U_kgDOBYuelA","avatar_url":"https://avatars.githubusercontent.com/u/93036180?v=4","gravatar_id":"","url":"https://api.github.com/users/AfterSnows","html_url":"https://github.com/AfterSnows","followers_url":"https://api.github.com/users/AfterSnows/followers","following_url":"https://api.github.com/users/AfterSnows/following{/other_user}","gists_url":"https://api.github.com/users/AfterSnows/gists{/gist_id}","starred_url":"https://api.github.com/users/AfterSnows/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AfterSnows/subscriptions","organizations_url":"https://api.github.com/users/AfterSnows/orgs","repos_url":"https://api.github.com/users/AfterSnows/repos","events_url":"https://api.github.com/users/AfterSnows/events{/privacy}","received_events_url":"https://api.github.com/users/AfterSnows/received_events","type":"User","site_admin":false},"type":"finder"}]},{"ghsa_id":"GHSA-p528-3mvf-gr87","cve_id":"CVE-2024-37084","url":"https://api.github.com/advisories/GHSA-p528-3mvf-gr87","html_url":"https://github.com/advisories/GHSA-p528-3mvf-gr87","summary":"Remote code execution in Spring Cloud Data Flow","description":"In Spring Cloud Data Flow versions prior to 2.11.4,  a malicious user who has access to the Skipper server api can use a crafted upload request to write an arbitrary file to any location on the file system which could lead to compromising the server","type":"reviewed","severity":"critical","repository_advisory_url":null,"source_code_location":"https://github.com/spring-cloud/spring-cloud-dataflow","identifiers":[{"value":"GHSA-p528-3mvf-gr87","type":"GHSA"},{"value":"CVE-2024-37084","type":"CVE"}],"references":["https://nvd.nist.gov/vuln/detail/CVE-2024-37084","https://spring.io/security/cve-2024-37084","https://github.com/advisories/GHSA-p528-3mvf-gr87"],"published_at":"2024-07-25T12:32:00Z","updated_at":"2024-07-25T15:19:47Z","github_reviewed_at":"2024-07-25T15:19:46Z","nvd_published_at":"2024-07-25T10:15:07Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"maven","name":"org.springframework.cloud:spring-cloud-skipper"},"vulnerable_version_range":"< 2.11.4","first_patched_version":"2.11.4","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H","score":9.8},"cwes":[{"cwe_id":"CWE-22","name":"Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"}],"credits":[]},{"ghsa_id":"GHSA-vprp-94p9-5jp8","cve_id":"CVE-2024-40137","url":"https://api.github.com/advisories/GHSA-vprp-94p9-5jp8","html_url":"https://github.com/advisories/GHSA-vprp-94p9-5jp8","summary":"Dolibarr ERP CRM vulnerable to remote code execution (RCE) ","description":"Dolibarr ERP CRM before 19.0.2 was discovered to contain a remote code execution (RCE) vulnerability via the Computed field parameter under the Users Module Setup function.","type":"reviewed","severity":"high","repository_advisory_url":null,"source_code_location":"https://github.com/Dolibarr/dolibarr","identifiers":[{"value":"GHSA-vprp-94p9-5jp8","type":"GHSA"},{"value":"CVE-2024-40137","type":"CVE"}],"references":["https://nvd.nist.gov/vuln/detail/CVE-2024-40137","https://github.com/c0d3x27/CVEs/tree/main/CVE-2024-40137","https://github.com/advisories/GHSA-vprp-94p9-5jp8"],"published_at":"2024-07-24T21:31:30Z","updated_at":"2024-07-25T16:44:51Z","github_reviewed_at":"2024-07-25T16:44:50Z","nvd_published_at":"2024-07-24T19:15:04Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"composer","name":"dolibarr/dolibarr"},"vulnerable_version_range":"< 19.0.2","first_patched_version":null,"vulnerable_functions":[]}],"cvss":{"vector_string":null,"score":null},"cwes":[],"credits":[]},{"ghsa_id":"GHSA-v8wx-v5jq-qhhw","cve_id":"CVE-2024-41666","url":"https://api.github.com/advisories/GHSA-v8wx-v5jq-qhhw","html_url":"https://github.com/advisories/GHSA-v8wx-v5jq-qhhw","summary":"The Argo CD web terminal session does not handle the revocation of user permissions properly","description":"Argo CD v2.11.3 and before, discovering that even if the user's ```p, role:myrole, exec, create, */*, allow``` permissions are revoked, the user can still send any Websocket message, which allows the user to view sensitive information. Even though they shouldn't have such access.\n\n## Description\nArgo CD has a Web-based terminal that allows you to get a shell inside a running pod, just like you would with kubectl exec. However, when the administrator enables this function and grants permission to the user ```p, role:myrole, exec, create, */*, allow```, even if the user revokes this permission, the user can still perform operations in the container, as long as the user keeps the terminal view open for a long time. CVE-2023-40025 Although the token expiration and revocation of the user are fixed, however, the fix does not address the situation of revocation of only user ```p, role:myrole, exec, create, */*, allow``` permissions, which may still lead to the leakage of sensitive information.\n\n### Patches\nA patch for this vulnerability has been released in the following Argo CD versions:\n\nv2.11.7\nv2.10.16\nv2.9.21\n\n### For more information\nIf you have any questions or comments about this advisory:\n\nOpen an issue in [the Argo CD issue tracker](https://github.com/argoproj/argo-cd/issues) or [discussions](https://github.com/argoproj/argo-cd/discussions)\nJoin us on [Slack](https://argoproj.github.io/community/join-slack) in channel #argo-cd\n\n### Credits\nThis vulnerability was found & reported by \nShengjie Li, Huazhong University of Science and Technology\nZhi Li, Huazhong University of Science and Technology\nWeijie Liu, Nankai University\n\nThe Argo team would like to thank these contributors for their responsible disclosure and constructive communications during the resolve of this issue","type":"reviewed","severity":"medium","repository_advisory_url":"https://api.github.com/repos/argoproj/argo-cd/security-advisories/GHSA-v8wx-v5jq-qhhw","source_code_location":"https://github.com/argoproj/argo-cd","identifiers":[{"value":"GHSA-v8wx-v5jq-qhhw","type":"GHSA"},{"value":"CVE-2024-41666","type":"CVE"}],"references":["https://github.com/argoproj/argo-cd/security/advisories/GHSA-v8wx-v5jq-qhhw","https://nvd.nist.gov/vuln/detail/CVE-2024-41666","https://github.com/argoproj/argo-cd/commit/05edb2a9ca48f0f10608c1b49fbb0cf7164f6476","https://github.com/argoproj/argo-cd/commit/e96f32d233504101ddac028a5bf8117433d333d6","https://github.com/argoproj/argo-cd/commit/ef535230d8bd8ad7b18aab1ea1063e9751d348c4","https://drive.google.com/file/d/1Fynj5Sho8Lf8CETqsNXZyPKlTDdmgJuN/view?usp=sharing","https://github.com/advisories/GHSA-v8wx-v5jq-qhhw"],"published_at":"2024-07-24T20:54:02Z","updated_at":"2024-07-24T20:54:03Z","github_reviewed_at":"2024-07-24T20:54:02Z","nvd_published_at":"2024-07-24T18:15:05Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"go","name":"github.com/argoproj/argo-cd"},"vulnerable_version_range":">= 2.6.0, < 2.9.21","first_patched_version":"2.9.21","vulnerable_functions":[]},{"package":{"ecosystem":"go","name":"github.com/argoproj/argo-cd"},"vulnerable_version_range":">= 2.10.0, < 2.10.16","first_patched_version":"2.10.16","vulnerable_functions":[]},{"package":{"ecosystem":"go","name":"github.com/argoproj/argo-cd"},"vulnerable_version_range":">= 2.11.0, < 2.11.7","first_patched_version":"2.11.7","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L","score":4.7},"cwes":[{"cwe_id":"CWE-269","name":"Improper Privilege Management"}],"credits":[{"user":{"login":"ClownandBox","id":101938504,"node_id":"U_kgDOBhN1SA","avatar_url":"https://avatars.githubusercontent.com/u/101938504?v=4","gravatar_id":"","url":"https://api.github.com/users/ClownandBox","html_url":"https://github.com/ClownandBox","followers_url":"https://api.github.com/users/ClownandBox/followers","following_url":"https://api.github.com/users/ClownandBox/following{/other_user}","gists_url":"https://api.github.com/users/ClownandBox/gists{/gist_id}","starred_url":"https://api.github.com/users/ClownandBox/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ClownandBox/subscriptions","organizations_url":"https://api.github.com/users/ClownandBox/orgs","repos_url":"https://api.github.com/users/ClownandBox/repos","events_url":"https://api.github.com/users/ClownandBox/events{/privacy}","received_events_url":"https://api.github.com/users/ClownandBox/received_events","type":"User","site_admin":false},"type":"reporter"},{"user":{"login":"crenshaw-dev","id":350466,"node_id":"MDQ6VXNlcjM1MDQ2Ng==","avatar_url":"https://avatars.githubusercontent.com/u/350466?v=4","gravatar_id":"","url":"https://api.github.com/users/crenshaw-dev","html_url":"https://github.com/crenshaw-dev","followers_url":"https://api.github.com/users/crenshaw-dev/followers","following_url":"https://api.github.com/users/crenshaw-dev/following{/other_user}","gists_url":"https://api.github.com/users/crenshaw-dev/gists{/gist_id}","starred_url":"https://api.github.com/users/crenshaw-dev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/crenshaw-dev/subscriptions","organizations_url":"https://api.github.com/users/crenshaw-dev/orgs","repos_url":"https://api.github.com/users/crenshaw-dev/repos","events_url":"https://api.github.com/users/crenshaw-dev/events{/privacy}","received_events_url":"https://api.github.com/users/crenshaw-dev/received_events","type":"User","site_admin":false},"type":"remediation_reviewer"},{"user":{"login":"pasha-codefresh","id":39732895,"node_id":"MDQ6VXNlcjM5NzMyODk1","avatar_url":"https://avatars.githubusercontent.com/u/39732895?v=4","gravatar_id":"","url":"https://api.github.com/users/pasha-codefresh","html_url":"https://github.com/pasha-codefresh","followers_url":"https://api.github.com/users/pasha-codefresh/followers","following_url":"https://api.github.com/users/pasha-codefresh/following{/other_user}","gists_url":"https://api.github.com/users/pasha-codefresh/gists{/gist_id}","starred_url":"https://api.github.com/users/pasha-codefresh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pasha-codefresh/subscriptions","organizations_url":"https://api.github.com/users/pasha-codefresh/orgs","repos_url":"https://api.github.com/users/pasha-codefresh/repos","events_url":"https://api.github.com/users/pasha-codefresh/events{/privacy}","received_events_url":"https://api.github.com/users/pasha-codefresh/received_events","type":"User","site_admin":false},"type":"remediation_developer"}]},
    {"ghsa_id":"GHSA-8gj9-r4hv-3jjw","cve_id":"CVE-2024-39676","url":"https://api.github.com/advisories/GHSA-8gj9-r4hv-3jjw","html_url":"https://github.com/advisories/GHSA-8gj9-r4hv-3jjw","summary":"Apache Pinot: Unauthorized endpoint exposed sensitive information","description":"Exposure of Sensitive Information to an Unauthorized Actor vulnerability in Apache Pinot.\n\nThis issue affects Apache Pinot: from 0.1 before 1.0.0.\n\nUsers are recommended to upgrade to version 1.0.0 and configure RBAC, which fixes the issue.\n\nDetails: \n\nWhen using a request to path `/appconfigs` to the controller, it can lead to the disclosure of sensitive information such as system information (e.g. arch, os version), environment information (e.g. maxHeapSize) and Pinot configurations (e.g. zookeeper path). This issue was addressed by the Role-based Access Control https://docs.pinot.apache.org/operators/tutorials/authentication/basic-auth-access-control , so that `/appConfigs` and all other APIs can be access controlled. Only authorized users have access to it. Note the user needs to add the admin role accordingly to the RBAC guide to control access to this endpoint, and in the future version of Pinot, a default admin role is planned to be added.","type":"reviewed","severity":"high","repository_advisory_url":null,"source_code_location":"https://github.com/apache/pinot","identifiers":[{"value":"GHSA-8gj9-r4hv-3jjw","type":"GHSA"},{"value":"CVE-2024-39676","type":"CVE"}],"references":["https://nvd.nist.gov/vuln/detail/CVE-2024-39676","https://lists.apache.org/thread/hsm0b2w8qr0sqy4rj1mfnnw286tslpzc","https://docs.pinot.apache.org/operators/tutorials/authentication/basic-auth-access-control","https://github.com/advisories/GHSA-8gj9-r4hv-3jjw"],"published_at":"2024-07-24T09:30:40Z","updated_at":"2024-07-24T14:59:49Z","github_reviewed_at":"2024-07-24T14:59:48Z","nvd_published_at":"2024-07-24T08:15:02Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"maven","name":"org.apache.pinot:pinot-controller"},"vulnerable_version_range":">= 0.1, < 1.0.0","first_patched_version":"1.0.0","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N","score":7.5},"cwes":[{"cwe_id":"CWE-200","name":"Exposure of Sensitive Information to an Unauthorized Actor"}],"credits":[{"user":{"login":"oscerd","id":5106647,"node_id":"MDQ6VXNlcjUxMDY2NDc=","avatar_url":"https://avatars.githubusercontent.com/u/5106647?v=4","gravatar_id":"","url":"https://api.github.com/users/oscerd","html_url":"https://github.com/oscerd","followers_url":"https://api.github.com/users/oscerd/followers","following_url":"https://api.github.com/users/oscerd/following{/other_user}","gists_url":"https://api.github.com/users/oscerd/gists{/gist_id}","starred_url":"https://api.github.com/users/oscerd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oscerd/subscriptions","organizations_url":"https://api.github.com/users/oscerd/orgs","repos_url":"https://api.github.com/users/oscerd/repos","events_url":"https://api.github.com/users/oscerd/events{/privacy}","received_events_url":"https://api.github.com/users/oscerd/received_events","type":"User","site_admin":false},"type":"analyst"}]},
    {"ghsa_id":"GHSA-v62g-jwj9-rfvx","cve_id":"CVE-2023-48362","url":"https://api.github.com/advisories/GHSA-v62g-jwj9-rfvx","html_url":"https://github.com/advisories/GHSA-v62g-jwj9-rfvx","summary":"XML External Entity Reference (XXE) in the XML Format Plugin in Apache Drill","description":"XXE in the XML Format Plugin in Apache Drill version 1.19.0 and greater allows a user to read any file on a remote file system or execute commands via a malicious XML file. Users are recommended to upgrade to version 1.21.2, which fixes this issue.","type":"reviewed","severity":"medium","repository_advisory_url":null,"source_code_location":"https://github.com/apache/drill/","identifiers":[{"value":"GHSA-v62g-jwj9-rfvx","type":"GHSA"},{"value":"CVE-2023-48362","type":"CVE"}],"references":["https://nvd.nist.gov/vuln/detail/CVE-2023-48362","https://lists.apache.org/thread/9tt0q4bdjwgw0dz0l9knqxjnpb5y6zsl","https://github.com/apache/drill/commit/0e88b7a5101d24c561a2a3efb12d7a3b3f7933f3","https://issues.apache.org/jira/browse/DRILL-8461","http://www.openwall.com/lists/oss-security/2024/07/24/3","https://github.com/advisories/GHSA-v62g-jwj9-rfvx"],"published_at":"2024-07-24T09:30:40Z","updated_at":"2024-07-24T16:02:36Z","github_reviewed_at":"2024-07-24T16:02:33Z","nvd_published_at":"2024-07-24T08:15:02Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"maven","name":"org.apache.drill.exec:drill-java-exec"},"vulnerable_version_range":">= 1.19.0, < 1.21.2","first_patched_version":"1.21.2","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N","score":6.4},"cwes":[{"cwe_id":"CWE-611","name":"Improper Restriction of XML External Entity Reference"}],"credits":[]},{"ghsa_id":"GHSA-rm86-h44c-2r2m","cve_id":"CVE-2024-40767","url":"https://api.github.com/advisories/GHSA-rm86-h44c-2r2m","html_url":"https://github.com/advisories/GHSA-rm86-h44c-2r2m","summary":"OpenStack Nova vulnerable to unauthorized access to potentially sensitive data ","description":"In OpenStack Nova before 27.4.1, 28 before 28.2.1, and 29 before 29.1.1, by supplying a raw format image that is actually a crafted QCOW2 image with a backing file path or VMDK flat image with a descriptor file path, an authenticated user may convince systems to return a copy of the referenced file's contents from the server, resulting in unauthorized access to potentially sensitive data. All Nova deployments are affected. NOTE: this issue exists because of an incomplete fix for CVE-2022-47951 and CVE-2024-32498.","type":"reviewed","severity":"medium","repository_advisory_url":null,"source_code_location":"https://github.com/openstack/nova","identifiers":[{"value":"GHSA-rm86-h44c-2r2m","type":"GHSA"},{"value":"CVE-2024-40767","type":"CVE"}],"references":["https://nvd.nist.gov/vuln/detail/CVE-2024-40767","https://launchpad.net/bugs/2071734","https://security.openstack.org","https://www.openwall.com/lists/oss-security/2024/07/23/2","https://review.opendev.org/c/openstack/nova/+/924731","https://security.openstack.org/ossa/OSSA-2024-002.html","https://github.com/advisories/GHSA-rm86-h44c-2r2m"],"published_at":"2024-07-24T06:31:10Z","updated_at":"2024-07-26T21:39:47Z","github_reviewed_at":"2024-07-25T14:27:53Z","nvd_published_at":"2024-07-24T05:15:12Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"pip","name":"Nova"},"vulnerable_version_range":"<= 27.4.0","first_patched_version":null,"vulnerable_functions":[]},{"package":{"ecosystem":"pip","name":"Nova"},"vulnerable_version_range":">= 28.0.0, <= 28.2.0","first_patched_version":null,"vulnerable_functions":[]},{"package":{"ecosystem":"pip","name":"Nova"},"vulnerable_version_range":">= 29.0.0, <= 29.1.0","first_patched_version":null,"vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N","score":6.5},"cwes":[{"cwe_id":"CWE-436","name":"Interpretation Conflict"}],"credits":[]},{"ghsa_id":"GHSA-fm88-hc3v-3www","cve_id":"CVE-2024-41656","url":"https://api.github.com/advisories/GHSA-fm88-hc3v-3www","html_url":"https://github.com/advisories/GHSA-fm88-hc3v-3www","summary":"Sentry vulnerable to stored Cross-Site Scripting (XSS)","description":"### Impact\nAn unsanitized payload sent by an Integration platform integration allows the storage of arbitrary HTML tags on the Sentry side. This payload could subsequently be rendered on the Issues page, creating a Stored Cross-Site Scripting (XSS) vulnerability. This vulnerability might lead to the execution of arbitrary scripts in the context of a user’s browser.\n\nSelf-hosted Sentry users may be impacted if untrustworthy Integration platform integrations send external issues to their Sentry instance.\n\n### Patches\nThe patch has been released in [Sentry 24.7.1](https://github.com/getsentry/self-hosted/releases/tag/24.7.1)\n\n### Workarounds\nFor Sentry SaaS customers, no action is needed. This has been patched on July 22, and even prior to the fix, the exploitation was not possible due to the strict Content Security Policy deployed on sentry.io site.\n\nFor self-hosted users, we strongly recommend upgrading Sentry to the latest version. If it is not possible, you could [enable CSP on your self-hosted installation](https://develop.sentry.dev/self-hosted/csp/) with `CSP_REPORT_ONLY = False` (enforcing mode). This will mitigate the risk of XSS.\n\n### References\n* Sentry Docs: [Integration platform / Create an External Issue](https://docs.sentry.io/api/integration/create-an-external-issue/)\n* Sentry Docs: [Self-hosted CSP](https://develop.sentry.dev/self-hosted/csp/)\n* The fix: https://github.com/getsentry/sentry/pull/74648\n* PortSwigger: [Stored XSS](https://portswigger.net/web-security/cross-site-scripting/stored)","type":"reviewed","severity":"high","repository_advisory_url":"https://api.github.com/repos/getsentry/sentry/security-advisories/GHSA-fm88-hc3v-3www","source_code_location":"https://github.com/getsentry/sentry","identifiers":[{"value":"GHSA-fm88-hc3v-3www","type":"GHSA"},{"value":"CVE-2024-41656","type":"CVE"}],"references":["https://github.com/getsentry/sentry/security/advisories/GHSA-fm88-hc3v-3www","https://github.com/getsentry/sentry/pull/74648","https://github.com/getsentry/self-hosted/releases/tag/24.7.1","https://nvd.nist.gov/vuln/detail/CVE-2024-41656","https://github.com/getsentry/sentry/commit/5c679521f1539eabfb81287bfc30f34dbecd373e","https://github.com/advisories/GHSA-fm88-hc3v-3www"],"published_at":"2024-07-23T20:46:39Z","updated_at":"2024-07-24T13:48:57Z","github_reviewed_at":"2024-07-23T20:46:39Z","nvd_published_at":"2024-07-23T22:15:08Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"pip","name":"sentry"},"vulnerable_version_range":">= 10.0.0, < 24.7.1","first_patched_version":"24.7.1","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:H","score":7.1},"cwes":[{"cwe_id":"CWE-79","name":"Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"},{"cwe_id":"CWE-80","name":"Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)"}],"credits":[{"user":{"login":"stsewd","id":4975310,"node_id":"MDQ6VXNlcjQ5NzUzMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4975310?v=4","gravatar_id":"","url":"https://api.github.com/users/stsewd","html_url":"https://github.com/stsewd","followers_url":"https://api.github.com/users/stsewd/followers","following_url":"https://api.github.com/users/stsewd/following{/other_user}","gists_url":"https://api.github.com/users/stsewd/gists{/gist_id}","starred_url":"https://api.github.com/users/stsewd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stsewd/subscriptions","organizations_url":"https://api.github.com/users/stsewd/orgs","repos_url":"https://api.github.com/users/stsewd/repos","events_url":"https://api.github.com/users/stsewd/events{/privacy}","received_events_url":"https://api.github.com/users/stsewd/received_events","type":"User","site_admin":false},"type":"reporter"}]},{"ghsa_id":"GHSA-c2hf-vcmr-qjrf","cve_id":"CVE-2024-41178","url":"https://api.github.com/advisories/GHSA-c2hf-vcmr-qjrf","html_url":"https://github.com/advisories/GHSA-c2hf-vcmr-qjrf","summary":"Apache Arrow Rust Object Store: AWS WebIdentityToken exposure in log files","description":"Exposure of temporary credentials in logs in Apache Arrow Rust Object Store (`object_store` crate), version 0.10.1 and earlier on all platforms using AWS WebIdentityTokens. \n\nOn certain error conditions, the logs may contain the OIDC token passed to  AssumeRoleWithWebIdentity https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithWebIdentity.html . This allows someone with access to the logs to impersonate that identity, including performing their own calls to AssumeRoleWithWebIdentity, until the OIDC token expires. Typically OIDC tokens are valid for up to an hour, although this will vary depending on the issuer.\n\nUsers are recommended to use a different AWS authentication mechanism, disable logging or upgrade to version 0.10.2, which fixes this issue.\n\nDetails:\n\nWhen using AWS WebIdentityTokens with the object_store crate, in the event of a failure and automatic retry, the underlying reqwest error, including the full URL with the credentials, potentially in the parameters, is written to the logs. \n\nThanks to Paul Hatcherian for reporting this vulnerability","type":"reviewed","severity":"medium","repository_advisory_url":null,"source_code_location":"https://github.com/apache/arrow-rs","identifiers":[{"value":"GHSA-c2hf-vcmr-qjrf","type":"GHSA"},{"value":"CVE-2024-41178","type":"CVE"}],"references":["https://nvd.nist.gov/vuln/detail/CVE-2024-41178","https://lists.apache.org/thread/3t0povdppnt2czv6crlsqhvyko93kcrg","https://github.com/apache/arrow-rs/pull/6074","https://github.com/apache/arrow-rs/commit/4978e32654235f569062f2cad6c7361e410f1254","https://rustsec.org/advisories/RUSTSEC-2024-0358.html","http://www.openwall.com/lists/oss-security/2024/07/23/3","https://github.com/advisories/GHSA-c2hf-vcmr-qjrf"],"published_at":"2024-07-23T18:31:07Z","updated_at":"2024-07-24T14:59:03Z","github_reviewed_at":"2024-07-24T14:59:02Z","nvd_published_at":"2024-07-23T17:15:12Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"rust","name":"object_store"},"vulnerable_version_range":">= 0.5.0, < 0.10.2","first_patched_version":"0.10.2","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:N","score":3.8},"cwes":[{"cwe_id":"CWE-532","name":"Insertion of Sensitive Information into Log File"}],"credits":[{"user":{"login":"oscerd","id":5106647,"node_id":"MDQ6VXNlcjUxMDY2NDc=","avatar_url":"https://avatars.githubusercontent.com/u/5106647?v=4","gravatar_id":"","url":"https://api.github.com/users/oscerd","html_url":"https://github.com/oscerd","followers_url":"https://api.github.com/users/oscerd/followers","following_url":"https://api.github.com/users/oscerd/following{/other_user}","gists_url":"https://api.github.com/users/oscerd/gists{/gist_id}","starred_url":"https://api.github.com/users/oscerd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oscerd/subscriptions","organizations_url":"https://api.github.com/users/oscerd/orgs","repos_url":"https://api.github.com/users/oscerd/repos","events_url":"https://api.github.com/users/oscerd/events{/privacy}","received_events_url":"https://api.github.com/users/oscerd/received_events","type":"User","site_admin":false},"type":"analyst"}]},{"ghsa_id":"GHSA-g3ch-rx76-35fx","cve_id":"CVE-2024-6783","url":"https://api.github.com/advisories/GHSA-g3ch-rx76-35fx","html_url":"https://github.com/advisories/GHSA-g3ch-rx76-35fx","summary":"vue-template-compiler vulnerable to client-side Cross-Site Scripting (XSS)","description":"A vulnerability has been discovered in vue-template-compiler, that allows an attacker to perform XSS via prototype pollution. The attacker could change the prototype chain of some properties such as `Object.prototype.staticClass` or `Object.prototype.staticStyle` to execute arbitrary JavaScript code. Vue 2 has reached End-of-Life. This vulnerability has been patched in Vue 3.","type":"reviewed","severity":"medium","repository_advisory_url":null,"source_code_location":"https://github.com/vuejs/vue","identifiers":[{"value":"GHSA-g3ch-rx76-35fx","type":"GHSA"},{"value":"CVE-2024-6783","type":"CVE"}],"references":["https://nvd.nist.gov/vuln/detail/CVE-2024-6783","https://www.herodevs.com/vulnerability-directory/cve-2024-6783---vue-client-side-xss","https://github.com/advisories/GHSA-g3ch-rx76-35fx"],"published_at":"2024-07-23T15:31:09Z","updated_at":"2024-07-23T16:26:54Z","github_reviewed_at":"2024-07-23T16:26:53Z","nvd_published_at":"2024-07-23T15:15:06Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"npm","name":"vue-template-compiler"},"vulnerable_version_range":">= 2.0.0, < 3.0.0","first_patched_version":"3.0.0","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N","score":4.8},"cwes":[{"cwe_id":"CWE-79","name":"Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"}],"credits":[]},{"ghsa_id":"GHSA-8h55-q5qq-p685","cve_id":"CVE-2024-41655","url":"https://api.github.com/advisories/GHSA-8h55-q5qq-p685","html_url":"https://github.com/advisories/GHSA-8h55-q5qq-p685","summary":"(ReDoS) Regular Expression Denial of Service in tf2-item-format","description":"## Summary\n\nVersions of `tf2-item-format` since at least `4.2.6` are vulnerable to a Regular Expression Denial of Service (ReDoS) attack when parsing crafted user input. \n\n## Tested Versions\n\n- `5.9.13`\n- `5.8.10`\n- `5.7.0`\n- `5.6.17`\n- `4.3.5`\n- `4.2.6`\n\n### v5\nUpgrade package to `^5.9.14`\n\n### v4\nNo patch exists. Please consult the [v4 to v5 migration guide](https://github.com/danocmx/node-tf2-item-format?tab=readme-ov-file#migrating-from-v4-to-v5) to upgrade to v5.\n\nIf upgrading to v5 is not possible, fork the module repository and implement the fix detailed below.\n\n## Impact\n\nThis vulnerability can be exploited by an attacker to perform DoS attacks on any service that uses any `tf2-item-format` to parse user input.","type":"reviewed","severity":"high","repository_advisory_url":"https://api.github.com/repos/danocmx/node-tf2-item-format/security-advisories/GHSA-8h55-q5qq-p685","source_code_location":"https://github.com/danocmx/node-tf2-item-format","identifiers":[{"value":"GHSA-8h55-q5qq-p685","type":"GHSA"},{"value":"CVE-2024-41655","type":"CVE"}],"references":["https://github.com/danocmx/node-tf2-item-format/security/advisories/GHSA-8h55-q5qq-p685","https://nvd.nist.gov/vuln/detail/CVE-2024-41655","https://github.com/danocmx/node-tf2-item-format/commit/5cffcc16a9261d6a937bda72bfe6830e02e31eec","https://github.com/danocmx/node-tf2-item-format/releases/tag/v5.9.14","https://github.com/advisories/GHSA-8h55-q5qq-p685"],"published_at":"2024-07-23T14:10:45Z","updated_at":"2024-07-23T15:51:55Z","github_reviewed_at":"2024-07-23T14:10:45Z","nvd_published_at":"2024-07-23T15:15:05Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"npm","name":"tf2-item-format"},"vulnerable_version_range":">= 4.2.6, <= 5.9.13","first_patched_version":"5.9.14","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H","score":7.5},"cwes":[{"cwe_id":"CWE-624","name":"Executable Regular Expression Error"},{"cwe_id":"CWE-1333","name":"Inefficient Regular Expression Complexity"}],"credits":[{"user":{"login":"piman51277","id":44853490,"node_id":"MDQ6VXNlcjQ0ODUzNDkw","avatar_url":"https://avatars.githubusercontent.com/u/44853490?v=4","gravatar_id":"","url":"https://api.github.com/users/piman51277","html_url":"https://github.com/piman51277","followers_url":"https://api.github.com/users/piman51277/followers","following_url":"https://api.github.com/users/piman51277/following{/other_user}","gists_url":"https://api.github.com/users/piman51277/gists{/gist_id}","starred_url":"https://api.github.com/users/piman51277/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/piman51277/subscriptions","organizations_url":"https://api.github.com/users/piman51277/orgs","repos_url":"https://api.github.com/users/piman51277/repos","events_url":"https://api.github.com/users/piman51277/events{/privacy}","received_events_url":"https://api.github.com/users/piman51277/received_events","type":"User","site_admin":false},"type":"finder"}]},{"ghsa_id":"GHSA-qxrv-gp6x-rc23","cve_id":"CVE-2024-41132","url":"https://api.github.com/advisories/GHSA-qxrv-gp6x-rc23","html_url":"https://github.com/advisories/GHSA-qxrv-gp6x-rc23","summary":"SixLabors ImageSharp has Excessive Memory Allocation in Gif Decoder","description":"### Impact\n_What kind of vulnerability is it? Who is impacted?_\n\nA vulnerability discovered in the ImageSharp library, where the processing of specially crafted files can lead to excessive memory usage in the Gif decoder. The vulnerability is triggered when ImageSharp attempts to process image files that are designed to exploit this flaw.\n\n### Patches\n_Has the problem been patched? What versions should users upgrade to?_\n\nThe problem has been patched. All users are advised to upgrade to v3.1.5 or v2.1.9.\n\n### Workarounds\n_Is there a way for users to fix or remediate the vulnerability without upgrading?_\n\nBefore calling `Image.Decode(Async)`, use `Image.Identify` to determine the image dimensions in order to enforce a limit.\n\n### References\n_Are there any links users can visit to find out more?_\n- https://github.com/SixLabors/ImageSharp/pull/2759\n- https://github.com/SixLabors/ImageSharp/pull/2764\n- https://github.com/SixLabors/ImageSharp/pull/2770\n- ImageSharp: [Security Considerations](https://docs.sixlabors.com/articles/imagesharp/security.html)\n- ImageSharp.Web: [Securing Processing Commands](https://docs.sixlabors.com/articles/imagesharp.web/processingcommands.html#securing-processing-commands)","type":"reviewed","severity":"medium","repository_advisory_url":"https://api.github.com/repos/SixLabors/ImageSharp/security-advisories/GHSA-qxrv-gp6x-rc23","source_code_location":"https://github.com/SixLabors/ImageSharp","identifiers":[{"value":"GHSA-qxrv-gp6x-rc23","type":"GHSA"},{"value":"CVE-2024-41132","type":"CVE"}],"references":["https://github.com/SixLabors/ImageSharp/security/advisories/GHSA-qxrv-gp6x-rc23","https://nvd.nist.gov/vuln/detail/CVE-2024-41132","https://github.com/SixLabors/ImageSharp/pull/2759","https://github.com/SixLabors/ImageSharp/pull/2764","https://github.com/SixLabors/ImageSharp/pull/2770","https://github.com/SixLabors/ImageSharp/commit/59de13c8cc47f2b402e2c43aa7024511d029d515","https://github.com/SixLabors/ImageSharp/commit/9816ca45016c5d3859986f3c600e8934bc450a56","https://github.com/SixLabors/ImageSharp/commit/b496109051cc39feee1f6cde48fca6481de17f9a","https://docs.sixlabors.com/articles/imagesharp.web/processingcommands.html#securing-processing-commands","https://docs.sixlabors.com/articles/imagesharp/security.html","https://github.com/advisories/GHSA-qxrv-gp6x-rc23"],"published_at":"2024-07-22T17:42:33Z","updated_at":"2024-07-22T17:42:34Z","github_reviewed_at":"2024-07-22T17:42:33Z","nvd_published_at":"2024-07-22T15:15:04Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"nuget","name":"SixLabors.ImageSharp"},"vulnerable_version_range":"< 2.1.9","first_patched_version":"2.1.9","vulnerable_functions":[]},{"package":{"ecosystem":"nuget","name":"SixLabors.ImageSharp"},"vulnerable_version_range":">= 3.0.0, < 3.1.5","first_patched_version":"3.1.5","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L","score":5.3},"cwes":[{"cwe_id":"CWE-789","name":"Memory Allocation with Excessive Size Value"}],"credits":[{"user":{"login":"ErazerBrecht","id":6287467,"node_id":"MDQ6VXNlcjYyODc0Njc=","avatar_url":"https://avatars.githubusercontent.com/u/6287467?v=4","gravatar_id":"","url":"https://api.github.com/users/ErazerBrecht","html_url":"https://github.com/ErazerBrecht","followers_url":"https://api.github.com/users/ErazerBrecht/followers","following_url":"https://api.github.com/users/ErazerBrecht/following{/other_user}","gists_url":"https://api.github.com/users/ErazerBrecht/gists{/gist_id}","starred_url":"https://api.github.com/users/ErazerBrecht/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ErazerBrecht/subscriptions","organizations_url":"https://api.github.com/users/ErazerBrecht/orgs","repos_url":"https://api.github.com/users/ErazerBrecht/repos","events_url":"https://api.github.com/users/ErazerBrecht/events{/privacy}","received_events_url":"https://api.github.com/users/ErazerBrecht/received_events","type":"User","site_admin":false},"type":"reporter"}]},{"ghsa_id":"GHSA-63p8-c4ww-9cg7","cve_id":"CVE-2024-41131","url":"https://api.github.com/advisories/GHSA-63p8-c4ww-9cg7","html_url":"https://github.com/advisories/GHSA-63p8-c4ww-9cg7","summary":"SixLabors ImageSharp Out-of-bounds Write","description":"### Impact\nAn Out-of-bounds Write vulnerability has been found in the ImageSharp gif decoder, allowing attackers to cause a crash using a specially crafted gif. This can potentially lead to denial of service.\n\n### Patches\nThe problem has been patched. All users are advised to upgrade to v3.1.5 or v2.1.9.\n\n### Workarounds\nNone.\n\n### References\nhttps://github.com/SixLabors/ImageSharp/pull/2754\nhttps://github.com/SixLabors/ImageSharp/pull/2756\n","type":"reviewed","severity":"high","repository_advisory_url":"https://api.github.com/repos/SixLabors/ImageSharp/security-advisories/GHSA-63p8-c4ww-9cg7","source_code_location":"https://github.com/SixLabors/ImageSharp","identifiers":[{"value":"GHSA-63p8-c4ww-9cg7","type":"GHSA"},{"value":"CVE-2024-41131","type":"CVE"}],"references":["https://github.com/SixLabors/ImageSharp/security/advisories/GHSA-63p8-c4ww-9cg7","https://nvd.nist.gov/vuln/detail/CVE-2024-41131","https://github.com/SixLabors/ImageSharp/pull/2754","https://github.com/SixLabors/ImageSharp/pull/2756","https://github.com/SixLabors/ImageSharp/commit/9dda64a8186af67baf06b6d9c1ab599c3608b693","https://github.com/SixLabors/ImageSharp/commit/a1f287977139109a987065643b8172c748abdadb","https://github.com/advisories/GHSA-63p8-c4ww-9cg7"],"published_at":"2024-07-22T17:42:07Z","updated_at":"2024-07-23T17:43:49Z","github_reviewed_at":"2024-07-22T17:42:07Z","nvd_published_at":"2024-07-22T15:15:03Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"nuget","name":"SixLabors.ImageSharp"},"vulnerable_version_range":"< 2.1.9","first_patched_version":"2.1.9","vulnerable_functions":[]},{"package":{"ecosystem":"nuget","name":"SixLabors.ImageSharp"},"vulnerable_version_range":">= 3.0.0, < 3.1.5","first_patched_version":"3.1.5","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H","score":7.5},"cwes":[{"cwe_id":"CWE-787","name":"Out-of-bounds Write"}],"credits":[{"user":{"login":"Erik-White","id":26148654,"node_id":"MDQ6VXNlcjI2MTQ4NjU0","avatar_url":"https://avatars.githubusercontent.com/u/26148654?v=4","gravatar_id":"","url":"https://api.github.com/users/Erik-White","html_url":"https://github.com/Erik-White","followers_url":"https://api.github.com/users/Erik-White/followers","following_url":"https://api.github.com/users/Erik-White/following{/other_user}","gists_url":"https://api.github.com/users/Erik-White/gists{/gist_id}","starred_url":"https://api.github.com/users/Erik-White/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Erik-White/subscriptions","organizations_url":"https://api.github.com/users/Erik-White/orgs","repos_url":"https://api.github.com/users/Erik-White/repos","events_url":"https://api.github.com/users/Erik-White/events{/privacy}","received_events_url":"https://api.github.com/users/Erik-White/received_events","type":"User","site_admin":false},"type":"reporter"}]},{"ghsa_id":"GHSA-hcmv-jmqh-fjgm","cve_id":"CVE-2024-41129","url":"https://api.github.com/advisories/GHSA-hcmv-jmqh-fjgm","html_url":"https://github.com/advisories/GHSA-hcmv-jmqh-fjgm","summary":"ops leaking secrets if `subprocess.CalledProcessError` happens with a `secret-*` CLI command","description":"### Summary\n\nThe issue here is that we pass the secret content as one of the args via CLI. This issue may affect any of our charms that are using: Juju (>=3.0), Juju secrets and not correctly capturing and processing `subprocess.CalledProcessError`.\n\nThere are two points that may log this command, in different files:\n\nFirst, if there is an error during a secret handling, there will be a `subprocess.CalledProcessError`, which will contain the CLI comand + all its args. This is going to be logged in any logging level. This exception, if not caught by the charm, will bubble up to the `/var/log/juju/` logs and syslog journal. Now, on Ubuntu 22.04, these logs are protected with:\n```\n${'$'} juju ssh -m controller 0 -- ls -la /var/log/juju/\ntotal 224\ndrwxr-xr-x 2 syslog adm      4096 Jul 14 10:59 .\ndrwxrwxr-x 9 root   syslog   4096 Jul 14 10:58 ..\n-rw-r----- 1 syslog adm     20124 Jul 14 11:10 audit.log\n-rw-r----- 1 syslog adm    110432 Jul 14 11:10 logsink.log\n-rw-r----- 1 syslog adm     80783 Jul 14 11:06 machine-0.log\n-rw-r----- 1 syslog adm       766 Jul 14 11:10 machine-lock.log\n-rw-r--r-- 1 root   root        0 Jul 14 10:59 slow-query.log\n-rw-r----- 1 syslog adm      3732 Jul 14 11:10 unit-controller-0.log\n```\n\nSecond, certain audit setups may log terminal commands, which would result in this command being logged with its secrets. It is unknown if this is done on ubuntu security benchmarks, such as CIS hardening.\n\nKeep in mind these logs may be copied or even backed up. Which exposes it to more services in the user's environment (e.g. CI runs in GH - although these are dummy password generated per test only).\n\nPassing secrets straight via CLI is not advised. Here are some ways out:\n1) Redacting: which commands and which args represent secrets are known, so they can be redacted. It would also mean capturing a `subprocess.CalledProcessError`, redacting its content and reissuing the same type of exception; this will not cover the case `auditd` is set to log CLI commands, if that is a risk\n2) Temp files: secret-add, for example, can use a secret file instead, [as can be seen here](https://github.com/juju/juju/blob/20b7d944acc985ce91419728529d5fb2abd14d68/cmd/juju/secrets/add.go#L62). However, if ops uses a file, ops will need to be sure to correctly remove it later\n3) stdin: not sure it is accepted by secret-* commands, but generally, secrets are not shown on CLI whilst typing them; auditd may not capture that stdin\n\n### Severity Rationale\n\nThis is a [CWE-532](https://cwe.mitre.org/data/definitions/532.html). Potentially, these secrets can lead to privilege escalation but Ubuntu default is to have logs only accessible to `adm` group users.\n\nMarking this issue as \"Moderate\", as this report is not presenting a clear way on how to get access to the logs themselves: either getting local access to an `adm` group user (e.g. ubuntu) or recovering logs stored on a 3rd party service.\n\n### Details\n```\n2024-07-12T14:27:58.0175389Z unit-opensearch-3: 14:27:53 ERROR unit.opensearch/3.juju-log certificates:11: Uncaught exception while in charm code:\n2024-07-12T14:27:58.0175524Z Traceback (most recent call last):\n2024-07-12T14:27:58.0175957Z   File \"/var/lib/juju/agents/unit-opensearch-3/charm/venv/ops/model.py\", line 3180, in _run\n2024-07-12T14:27:58.0176165Z     result = subprocess.run(args, **kwargs)  # type: ignore\n2024-07-12T14:27:58.0176381Z   File \"/usr/lib/python3.10/subprocess.py\", line 526, in run\n2024-07-12T14:27:58.0176561Z     raise CalledProcessError(retcode, process.args,\n2024-07-12T14:27:58.0177749Z subprocess.CalledProcessError: Command '('/var/lib/juju/tools/unit-opensearch-3/secret-add', '--label', 'opensearch:app:app-admin', '--owner', 'application', 'keystore-password-ca=aUE...')' returned non-zero exit status 1.\n2024-07-12T14:27:58.0177765Z\n2024-07-12T14:27:58.0178023Z The above exception was the direct cause of the following exception:\n2024-07-12T14:27:58.0178038Z\n2024-07-12T14:27:58.0178168Z Traceback (most recent call last):\n2024-07-12T14:27:58.0178588Z   File \"/var/lib/juju/agents/unit-opensearch-3/charm/./src/charm.py\", line 213, in <module>\n2024-07-12T14:27:58.0178724Z     main(OpenSearchOperatorCharm)\n2024-07-12T14:27:58.0179129Z   File \"/var/lib/juju/agents/unit-opensearch-3/charm/venv/ops/main.py\", line 548, in main\n2024-07-12T14:27:58.0179237Z     manager.run()\n2024-07-12T14:27:58.0179640Z   File \"/var/lib/juju/agents/unit-opensearch-3/charm/venv/ops/main.py\", line 527, in run\n2024-07-12T14:27:58.0179745Z     self._emit()\n2024-07-12T14:27:58.0180150Z   File \"/var/lib/juju/agents/unit-opensearch-3/charm/venv/ops/main.py\", line 516, in _emit\n2024-07-12T14:27:58.0180359Z     _emit_charm_event(self.charm, self.dispatcher.event_name)\n2024-07-12T14:27:58.0180840Z   File \"/var/lib/juju/agents/unit-opensearch-3/charm/venv/ops/main.py\", line 147, in _emit_charm_event\n2024-07-12T14:27:58.0180974Z     event_to_emit.emit(*args, **kwargs)\n2024-07-12T14:27:58.0181537Z   File \"/var/lib/juju/agents/unit-opensearch-3/charm/venv/ops/framework.py\", line 348, in emit\n2024-07-12T14:27:58.0181656Z     framework._emit(event)\n2024-07-12T14:27:58.0182091Z   File \"/var/lib/juju/agents/unit-opensearch-3/charm/venv/ops/framework.py\", line 860, in _emit\n2024-07-12T14:27:58.0182211Z     self._reemit(event_path)\n2024-07-12T14:27:58.0182659Z   File \"/var/lib/juju/agents/unit-opensearch-3/charm/venv/ops/framework.py\", line 950, in _reemit\n2024-07-12T14:27:58.0182770Z     custom_handler(event)\n2024-07-12T14:27:58.0183492Z   File \"/var/lib/juju/agents/unit-opensearch-3/charm/lib/charms/tls_certificates_interface/v3/tls_certificates.py\", line 1811, in _on_relation_changed\n2024-07-12T14:27:58.0183743Z     self.on.certificate_available.emit(\n2024-07-12T14:27:58.0184173Z   File \"/var/lib/juju/agents/unit-opensearch-3/charm/venv/ops/framework.py\", line 348, in emit\n2024-07-12T14:27:58.0184291Z     framework._emit(event)\n2024-07-12T14:27:58.0184717Z   File \"/var/lib/juju/agents/unit-opensearch-3/charm/venv/ops/framework.py\", line 860, in _emit\n2024-07-12T14:27:58.0184887Z     self._reemit(event_path)\n2024-07-12T14:27:58.0186171Z   File \"/var/lib/juju/agents/unit-opensearch-3/charm/venv/ops/framework.py\", line 950, in _reemit\n2024-07-12T14:27:58.0186306Z     custom_handler(event)\n2024-07-12T14:27:58.0187043Z   File \"/var/lib/juju/agents/unit-opensearch-3/charm/lib/charms/opensearch/v0/opensearch_tls.py\", line 209, in _on_certificate_available\n2024-07-12T14:27:58.0187320Z     self.store_new_ca(self.charm.secrets.get_object(scope, cert_type.val))\n2024-07-12T14:27:58.0187942Z   File \"/var/lib/juju/agents/unit-opensearch-3/charm/lib/charms/opensearch/v0/opensearch_tls.py\", line 444, in store_new_ca\n2024-07-12T14:27:58.0188242Z     self._create_keystore_pwd_if_not_exists(Scope.APP, CertType.APP_ADMIN, \"ca\")\n2024-07-12T14:27:58.0188981Z   File \"/var/lib/juju/agents/unit-opensearch-3/charm/lib/charms/opensearch/v0/opensearch_tls.py\", line 432, in _create_keystore_pwd_if_not_exists\n2024-07-12T14:27:58.0189119Z     self.charm.secrets.put_object(\n2024-07-12T14:27:58.0189738Z   File \"/var/lib/juju/agents/unit-opensearch-3/charm/lib/charms/opensearch/v0/opensearch_secrets.py\", line 359, in put_object\n2024-07-12T14:27:58.0189944Z     self._add_or_update_juju_secret(scope, key, value, merge)\n2024-07-12T14:27:58.0190652Z   File \"/var/lib/juju/agents/unit-opensearch-3/charm/lib/charms/opensearch/v0/opensearch_secrets.py\", line 272, in _add_or_update_juju_secret\n2024-07-12T14:27:58.0190815Z     return self._add_juju_secret(scope, key, value)\n2024-07-12T14:27:58.0191462Z   File \"/var/lib/juju/agents/unit-opensearch-3/charm/lib/charms/opensearch/v0/opensearch_secrets.py\", line 228, in _add_juju_secret\n2024-07-12T14:27:58.0191660Z     secret = scope_obj.add_secret(safe_value, label=label)\n2024-07-12T14:27:58.0192110Z   File \"/var/lib/juju/agents/unit-opensearch-3/charm/venv/ops/model.py\", line 477, in add_secret\n2024-07-12T14:27:58.0192241Z     id = self._backend.secret_add(\n2024-07-12T14:27:58.0192686Z   File \"/var/lib/juju/agents/unit-opensearch-3/charm/venv/ops/model.py\", line 3624, in secret_add\n2024-07-12T14:27:58.0192948Z     result = self._run('secret-add', *args, return_output=True)\n2024-07-12T14:27:58.0193356Z   File \"/var/lib/juju/agents/unit-opensearch-3/charm/venv/ops/model.py\", line 3182, in _run\n2024-07-12T14:27:58.0193489Z     raise ModelError(e.stderr) from e\n2024-07-12T14:27:58.0193685Z ops.model.ModelError: ERROR this unit is not the leader\n2024-07-12T14:27:58.0193692Z\n```\n\nFrom CI: https://github.com/canonical/opensearch-operator/actions/runs/9908987369/job/27376377521?pr=364\n\n### PoC\n1) Deploy anything with juju\n2) Run a dummy secret-add call that will fail\n3) See the uncaught subprocess error\n\n### Impact\nJuju secrets are generally composed of private keys, passwords, etc; generally valuable credentials that, if leaked, will likely allow an attacker to get privileged access to its target or other targets in the environment.\n","type":"reviewed","severity":"medium","repository_advisory_url":"https://api.github.com/repos/canonical/operator/security-advisories/GHSA-hcmv-jmqh-fjgm","source_code_location":"https://github.com/canonical/operator","identifiers":[{"value":"GHSA-hcmv-jmqh-fjgm","type":"GHSA"},{"value":"CVE-2024-41129","type":"CVE"}],"references":["https://github.com/canonical/operator/security/advisories/GHSA-hcmv-jmqh-fjgm","https://nvd.nist.gov/vuln/detail/CVE-2024-41129","https://github.com/canonical/operator/commit/fea6d2072435a62170d4c01272572f1a7e916e61","https://github.com/advisories/GHSA-hcmv-jmqh-fjgm"],"published_at":"2024-07-22T17:40:40Z","updated_at":"2024-07-22T17:40:41Z","github_reviewed_at":"2024-07-22T17:40:40Z","nvd_published_at":"2024-07-22T15:15:03Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"pip","name":"ops"},"vulnerable_version_range":">= 2.0.0, < 2.15.0","first_patched_version":"2.15.0","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N","score":4.4},"cwes":[{"cwe_id":"CWE-532","name":"Insertion of Sensitive Information into Log File"}],"credits":[{"user":{"login":"phvalguima","id":31036845,"node_id":"MDQ6VXNlcjMxMDM2ODQ1","avatar_url":"https://avatars.githubusercontent.com/u/31036845?v=4","gravatar_id":"","url":"https://api.github.com/users/phvalguima","html_url":"https://github.com/phvalguima","followers_url":"https://api.github.com/users/phvalguima/followers","following_url":"https://api.github.com/users/phvalguima/following{/other_user}","gists_url":"https://api.github.com/users/phvalguima/gists{/gist_id}","starred_url":"https://api.github.com/users/phvalguima/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/phvalguima/subscriptions","organizations_url":"https://api.github.com/users/phvalguima/orgs","repos_url":"https://api.github.com/users/phvalguima/repos","events_url":"https://api.github.com/users/phvalguima/events{/privacy}","received_events_url":"https://api.github.com/users/phvalguima/received_events","type":"User","site_admin":false},"type":"reporter"}]},{"ghsa_id":"GHSA-q445-7m23-qrmw","cve_id":null,"url":"https://api.github.com/advisories/GHSA-q445-7m23-qrmw","html_url":"https://github.com/advisories/GHSA-q445-7m23-qrmw","summary":"openssl's `MemBio::get_buf` has undefined behavior with empty buffers","description":"Previously, `MemBio::get_buf` called `slice::from_raw_parts` with a null-pointer, which violates the functions invariants, leading to undefined behavior. In debug builds this would produce an assertion failure. This is now fixed.\n","type":"reviewed","severity":"medium","repository_advisory_url":null,"source_code_location":"https://github.com/sfackler/rust-openssl","identifiers":[{"value":"GHSA-q445-7m23-qrmw","type":"GHSA"}],"references":["https://github.com/sfackler/rust-openssl/pull/2266","https://github.com/sfackler/rust-openssl/commit/aef36e0f3950653148d6644309ee41ccf16e02bb","https://github.com/sfackler/rust-openssl/releases/tag/openssl-v0.10.66","https://rustsec.org/advisories/RUSTSEC-2024-0357.html","https://github.com/advisories/GHSA-q445-7m23-qrmw"],"published_at":"2024-07-22T17:34:53Z","updated_at":"2024-07-22T17:34:54Z","github_reviewed_at":"2024-07-22T17:34:53Z","nvd_published_at":null,"withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"rust","name":"openssl"},"vulnerable_version_range":"< 0.10.66","first_patched_version":"0.10.66","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L","score":6.5},"cwes":[{"cwe_id":"CWE-476","name":"NULL Pointer Dereference"}],"credits":[]},{"ghsa_id":"GHSA-crjg-w57m-rqqf","cve_id":null,"url":"https://api.github.com/advisories/GHSA-crjg-w57m-rqqf","html_url":"https://github.com/advisories/GHSA-crjg-w57m-rqqf","summary":"DNSJava vulnerable to KeyTrap - Denial-of-Service Algorithmic Complexity Attacks","description":"### Impact\nUsers using the `ValidatingResolver` for DNSSEC validation can run into CPU exhaustion with specially crafted DNSSEC-signed zones.\n\n### Patches\nUsers should upgrade to dnsjava v3.6.0\n\n### Workarounds\nAlthough not recommended, only using a non-validating resolver, will remove the vulnerability. \n\n### References\nhttps://www.athene-center.de/en/keytrap\n","type":"reviewed","severity":"medium","repository_advisory_url":"https://api.github.com/repos/dnsjava/dnsjava/security-advisories/GHSA-crjg-w57m-rqqf","source_code_location":"https://github.com/dnsjava/dnsjava","identifiers":[{"value":"GHSA-crjg-w57m-rqqf","type":"GHSA"}],"references":["https://github.com/dnsjava/dnsjava/security/advisories/GHSA-crjg-w57m-rqqf","https://github.com/dnsjava/dnsjava/commit/07ac36a11578cc1bce0cd8ddf2fe568f062aee78","https://github.com/dnsjava/dnsjava/commit/3ddc45ce8cdb5c2274e10b7401416f497694e1cf","https://github.com/advisories/GHSA-crjg-w57m-rqqf"],"published_at":"2024-07-22T17:30:19Z","updated_at":"2024-07-22T17:30:20Z","github_reviewed_at":"2024-07-22T17:30:19Z","nvd_published_at":null,"withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"maven","name":"dnsjava:dnsjava"},"vulnerable_version_range":"< 3.6.0","first_patched_version":"3.6.0","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H","score":6.5},"cwes":[{"cwe_id":"CWE-770","name":"Allocation of Resources Without Limits or Throttling"}],"credits":[]},{"ghsa_id":"GHSA-jmvp-698c-4x3w","cve_id":"CVE-2024-40634","url":"https://api.github.com/advisories/GHSA-jmvp-698c-4x3w","html_url":"https://github.com/advisories/GHSA-jmvp-698c-4x3w","summary":"Argo CD Unauthenticated Denial of Service (DoS) Vulnerability via /api/webhook Endpoint","description":"### Summary\nThis report details a security vulnerability in Argo CD, where an unauthenticated attacker can send a specially crafted large JSON payload to the /api/webhook endpoint, causing excessive memory allocation that leads to service disruption by triggering an Out Of Memory (OOM) kill. The issue poses a high risk to the availability of Argo CD deployments.\n\n### Details\nThe webhook server always listens to requests. By default, the endpoint doesn't require authentication. It's possible to send a large, malicious request with headers (in this case \"X-GitHub-Event: push\") that will make ArgoCD start allocating memory to parse the incoming request. Since the request can be constructed client-side without allocating large amounts of memory, it can be arbitrarily large. Eventually, the argocd-server component will get OOMKilled as it consumes all its available memory.\n\nThe fix would be to enforce a limit on the size of the request being parsed.\n\n### PoC\nPort-forward to the argocd-server service, like so:\n\n```console\nkubectl port-forward svc/argocd-server -n argocd 8080:443\n```\n\nRun the below code:\n\n```go\npackage main\n\nimport (\n\t\"crypto/tls\"\n\t\"io\"\n\t\"net/http\"\n)\n\n// Define a custom io.Reader that generates a large dummy JSON payload.\ntype DummyJSONReader struct {\n\tsize int64 // Total size to generate\n\tread int64 // Bytes already generated\n}\n\n// Read generates the next chunk of the dummy JSON payload.\nfunc (r *DummyJSONReader) Read(p []byte) (n int, err error) {\n\tif r.read >= r.size {\n\t\treturn 0, io.EOF // Finished generating\n\t}\n\n\tstart := false\n\tif r.read == 0 {\n\t\t// Start of JSON\n\t\tp[0] = '{'\n\t\tp[1] = '\"'\n\t\tp[2] = 'd'\n\t\tp[3] = 'a'\n\t\tp[4] = 't'\n\t\tp[5] = 'a'\n\t\tp[6] = '\"'\n\t\tp[7] = ':'\n\t\tp[8] = '\"'\n\t\tn = 9\n\t\tstart = true\n\t}\n\n\tfor i := n; i < len(p); i++ {\n\t\tif r.read+int64(i)-int64(n)+1 == r.size-1 {\n\t\t\t// End of JSON\n\t\t\tp[i] = '\"'\n\t\t\tp[i+1] = '}'\n\t\t\tr.read += int64(i) + 2 - int64(n)\n\t\t\treturn i + 2 - n, nil\n\t\t} else {\n\t\t\tp[i] = 'x' // Dummy data\n\t\t}\n\t}\n\n\tr.read += int64(len(p)) - int64(n)\n\tif start {\n\t\treturn len(p), nil\n\t}\n\treturn len(p) - n, nil\n}\n\nfunc main() {\n\t// Initialize the custom reader with the desired size (16GB in this case).\n\tpayloadSize := int64(16) * 1024 * 1024 * 1024 // 16GB\n\treader := &DummyJSONReader{size: payloadSize}\n\n\t// HTTP client setup\n\thttpClient := &http.Client{\n\t\tTimeout: 0, // No timeout\n\t\tTransport: &http.Transport{\n\t\t\tTLSClientConfig: &tls.Config{InsecureSkipVerify: true},\n\t\t},\n\t}\n\n\treq, err := http.NewRequest(\"POST\", \"https://localhost:8080/api/webhook\", reader)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\n\t// Set headers\n\treq.Header.Set(\"Content-Type\", \"application/json\")\n\treq.Header.Set(\"X-GitHub-Event\", \"push\")\n\n\tresp, err := httpClient.Do(req)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tdefer resp.Body.Close()\n\n\tprintln(\"Response status code:\", resp.StatusCode)\n}\n```\n\n### Patches\nA patch for this vulnerability has been released in the following Argo CD versions:\n\nv2.11.6\nv2.10.15\nv2.9.20\n\n### For more information\nIf you have any questions or comments about this advisory:\n\nOpen an issue in [the Argo CD issue tracker](https://github.com/argoproj/argo-cd/issues) or [discussions](https://github.com/argoproj/argo-cd/discussions)\nJoin us on [Slack](https://argoproj.github.io/community/join-slack) in channel #argo-cd\n\n### Credits\nThis vulnerability was found & reported by Jakub Ciolek\n\nThe Argo team would like to thank these contributors for their responsible disclosure and constructive communications during the resolve of this issue\n","type":"reviewed","severity":"high","repository_advisory_url":"https://api.github.com/repos/argoproj/argo-cd/security-advisories/GHSA-jmvp-698c-4x3w","source_code_location":"https://github.com/argoproj/argo-cd","identifiers":[{"value":"GHSA-jmvp-698c-4x3w","type":"GHSA"},{"value":"CVE-2024-40634","type":"CVE"}],"references":["https://github.com/argoproj/argo-cd/security/advisories/GHSA-jmvp-698c-4x3w","https://github.com/argoproj/argo-cd/commit/46c0c0b64deaab1ece70cb701030b76668ad0cdc","https://github.com/argoproj/argo-cd/commit/540e3a57b90eb3655db54793332fac86bcc38b36","https://github.com/argoproj/argo-cd/commit/d881ee78949e23160a0b280bb159e4d3d625a4df","https://nvd.nist.gov/vuln/detail/CVE-2024-40634","https://github.com/advisories/GHSA-jmvp-698c-4x3w"],"published_at":"2024-07-22T17:20:02Z","updated_at":"2024-07-22T19:58:30Z","github_reviewed_at":"2024-07-22T17:20:02Z","nvd_published_at":"2024-07-22T18:15:03Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"go","name":"github.com/argoproj/argo-cd"},"vulnerable_version_range":">= 1.0.0, <= 1.8.7","first_patched_version":null,"vulnerable_functions":[]},{"package":{"ecosystem":"go","name":"github.com/argoproj/argo-cd/v2"},"vulnerable_version_range":"< 2.9.20","first_patched_version":"2.9.20","vulnerable_functions":[]},{"package":{"ecosystem":"go","name":"github.com/argoproj/argo-cd/v2"},"vulnerable_version_range":">= 2.10.0, < 2.10.15","first_patched_version":"2.10.15","vulnerable_functions":[]},{"package":{"ecosystem":"go","name":"github.com/argoproj/argo-cd/v2"},"vulnerable_version_range":">= 2.11.0, < 2.11.6","first_patched_version":"2.11.6","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H","score":7.5},"cwes":[{"cwe_id":"CWE-400","name":"Uncontrolled Resource Consumption"}],"credits":[{"user":{"login":"jake-ciolek","id":66125090,"node_id":"MDQ6VXNlcjY2MTI1MDkw","avatar_url":"https://avatars.githubusercontent.com/u/66125090?v=4","gravatar_id":"","url":"https://api.github.com/users/jake-ciolek","html_url":"https://github.com/jake-ciolek","followers_url":"https://api.github.com/users/jake-ciolek/followers","following_url":"https://api.github.com/users/jake-ciolek/following{/other_user}","gists_url":"https://api.github.com/users/jake-ciolek/gists{/gist_id}","starred_url":"https://api.github.com/users/jake-ciolek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jake-ciolek/subscriptions","organizations_url":"https://api.github.com/users/jake-ciolek/orgs","repos_url":"https://api.github.com/users/jake-ciolek/repos","events_url":"https://api.github.com/users/jake-ciolek/events{/privacy}","received_events_url":"https://api.github.com/users/jake-ciolek/received_events","type":"User","site_admin":false},"type":"reporter"},{"user":{"login":"crenshaw-dev","id":350466,"node_id":"MDQ6VXNlcjM1MDQ2Ng==","avatar_url":"https://avatars.githubusercontent.com/u/350466?v=4","gravatar_id":"","url":"https://api.github.com/users/crenshaw-dev","html_url":"https://github.com/crenshaw-dev","followers_url":"https://api.github.com/users/crenshaw-dev/followers","following_url":"https://api.github.com/users/crenshaw-dev/following{/other_user}","gists_url":"https://api.github.com/users/crenshaw-dev/gists{/gist_id}","starred_url":"https://api.github.com/users/crenshaw-dev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/crenshaw-dev/subscriptions","organizations_url":"https://api.github.com/users/crenshaw-dev/orgs","repos_url":"https://api.github.com/users/crenshaw-dev/repos","events_url":"https://api.github.com/users/crenshaw-dev/events{/privacy}","received_events_url":"https://api.github.com/users/crenshaw-dev/received_events","type":"User","site_admin":false},"type":"remediation_reviewer"},{"user":{"login":"pasha-codefresh","id":39732895,"node_id":"MDQ6VXNlcjM5NzMyODk1","avatar_url":"https://avatars.githubusercontent.com/u/39732895?v=4","gravatar_id":"","url":"https://api.github.com/users/pasha-codefresh","html_url":"https://github.com/pasha-codefresh","followers_url":"https://api.github.com/users/pasha-codefresh/followers","following_url":"https://api.github.com/users/pasha-codefresh/following{/other_user}","gists_url":"https://api.github.com/users/pasha-codefresh/gists{/gist_id}","starred_url":"https://api.github.com/users/pasha-codefresh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pasha-codefresh/subscriptions","organizations_url":"https://api.github.com/users/pasha-codefresh/orgs","repos_url":"https://api.github.com/users/pasha-codefresh/repos","events_url":"https://api.github.com/users/pasha-codefresh/events{/privacy}","received_events_url":"https://api.github.com/users/pasha-codefresh/received_events","type":"User","site_admin":false},"type":"remediation_developer"}]},{"ghsa_id":"GHSA-9gq7-p5w9-w899","cve_id":"CVE-2024-26020","url":"https://api.github.com/advisories/GHSA-9gq7-p5w9-w899","html_url":"https://github.com/advisories/GHSA-9gq7-p5w9-w899","summary":"Ankitects Anki arbitrary script execution vulnerability","description":"An arbitrary script execution vulnerability exists in the MPV functionality of Ankitects Anki 24.04. A specially crafted flashcard can lead to a arbitrary code execution. An attacker can send malicious flashcard to trigger this vulnerability.","type":"reviewed","severity":"critical","repository_advisory_url":null,"source_code_location":"https://github.com/ankitects/anki","identifiers":[{"value":"GHSA-9gq7-p5w9-w899","type":"GHSA"},{"value":"CVE-2024-26020","type":"CVE"}],"references":["https://nvd.nist.gov/vuln/detail/CVE-2024-26020","https://talosintelligence.com/vulnerability_reports/TALOS-2024-1993","https://github.com/ankitects/anki/commit/8d2e8b1e4fa3757581f224b1a57057d0455352ce","https://skerritt.blog/anki-0day","https://skii.dev/anki-0day","https://github.com/advisories/GHSA-9gq7-p5w9-w899"],"published_at":"2024-07-22T15:32:41Z","updated_at":"2024-07-25T18:28:00Z","github_reviewed_at":"2024-07-25T18:27:59Z","nvd_published_at":"2024-07-22T15:15:02Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"pip","name":"anki"},"vulnerable_version_range":"< 24.06","first_patched_version":"24.06","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H","score":9.7},"cwes":[{"cwe_id":"CWE-74","name":"Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')"}],"credits":[{"user":{"login":"bee-san","id":10378052,"node_id":"MDQ6VXNlcjEwMzc4MDUy","avatar_url":"https://avatars.githubusercontent.com/u/10378052?v=4","gravatar_id":"","url":"https://api.github.com/users/bee-san","html_url":"https://github.com/bee-san","followers_url":"https://api.github.com/users/bee-san/followers","following_url":"https://api.github.com/users/bee-san/following{/other_user}","gists_url":"https://api.github.com/users/bee-san/gists{/gist_id}","starred_url":"https://api.github.com/users/bee-san/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bee-san/subscriptions","organizations_url":"https://api.github.com/users/bee-san/orgs","repos_url":"https://api.github.com/users/bee-san/repos","events_url":"https://api.github.com/users/bee-san/events{/privacy}","received_events_url":"https://api.github.com/users/bee-san/received_events","type":"User","site_admin":false},"type":"analyst"}]},{"ghsa_id":"GHSA-q47p-v5rw-v574","cve_id":"CVE-2024-32152","url":"https://api.github.com/advisories/GHSA-q47p-v5rw-v574","html_url":"https://github.com/advisories/GHSA-q47p-v5rw-v574","summary":"Ankitects Anki LaTeX Blocklist Bypass vulnerability","description":"A blocklist bypass vulnerability exists in the LaTeX functionality of Ankitects Anki 24.04. A specially crafted malicious flashcard can lead to an arbitrary file creation at a fixed path. An attacker can share a malicious flashcard to trigger this vulnerability.","type":"reviewed","severity":"low","repository_advisory_url":null,"source_code_location":"https://github.com/ankitects/anki","identifiers":[{"value":"GHSA-q47p-v5rw-v574","type":"GHSA"},{"value":"CVE-2024-32152","type":"CVE"}],"references":["https://nvd.nist.gov/vuln/detail/CVE-2024-32152","https://talosintelligence.com/vulnerability_reports/TALOS-2024-1994","https://github.com/ankitects/anki/pull/3218","https://skerritt.blog/anki-0day","https://skii.dev/anki-0day","https://github.com/ankitects/anki/commit/06f7aa393d21d7d5dd8039e15d543b73c3346932","https://github.com/advisories/GHSA-q47p-v5rw-v574"],"published_at":"2024-07-22T15:32:41Z","updated_at":"2024-07-26T16:13:26Z","github_reviewed_at":"2024-07-25T14:44:26Z","nvd_published_at":"2024-07-22T15:15:03Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"pip","name":"anki"},"vulnerable_version_range":"< 24.6","first_patched_version":"24.6","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:N","score":3.1},"cwes":[{"cwe_id":"CWE-184","name":"Incomplete List of Disallowed Inputs"}],"credits":[{"user":{"login":"Jayy001","id":56607897,"node_id":"MDQ6VXNlcjU2NjA3ODk3","avatar_url":"https://avatars.githubusercontent.com/u/56607897?v=4","gravatar_id":"","url":"https://api.github.com/users/Jayy001","html_url":"https://github.com/Jayy001","followers_url":"https://api.github.com/users/Jayy001/followers","following_url":"https://api.github.com/users/Jayy001/following{/other_user}","gists_url":"https://api.github.com/users/Jayy001/gists{/gist_id}","starred_url":"https://api.github.com/users/Jayy001/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jayy001/subscriptions","organizations_url":"https://api.github.com/users/Jayy001/orgs","repos_url":"https://api.github.com/users/Jayy001/repos","events_url":"https://api.github.com/users/Jayy001/events{/privacy}","received_events_url":"https://api.github.com/users/Jayy001/received_events","type":"User","site_admin":false},"type":"analyst"}]},{"ghsa_id":"GHSA-x3r6-ccvq-cf5v","cve_id":"CVE-2024-29073","url":"https://api.github.com/advisories/GHSA-x3r6-ccvq-cf5v","html_url":"https://github.com/advisories/GHSA-x3r6-ccvq-cf5v","summary":"Anki Latex Incomplete Blocklist Vulnerability","description":"An vulnerability in the handling of Latex exists in Ankitects Anki 24.04. When Latex is sanitized to prevent unsafe commands, the verbatim package, which comes installed by default in many Latex distributions, has been overlooked. A specially crafted flashcard can lead to an arbitrary file read. An attacker can share a flashcard to trigger this vulnerability.","type":"reviewed","severity":"medium","repository_advisory_url":null,"source_code_location":"https://github.com/ankitects/anki","identifiers":[{"value":"GHSA-x3r6-ccvq-cf5v","type":"GHSA"},{"value":"CVE-2024-29073","type":"CVE"}],"references":["https://nvd.nist.gov/vuln/detail/CVE-2024-29073","https://talosintelligence.com/vulnerability_reports/TALOS-2024-1992","https://github.com/ankitects/anki/pull/3218","https://skerritt.blog/anki-0day","https://skii.dev/anki-0day","https://github.com/ankitects/anki/commit/06f7aa393d21d7d5dd8039e15d543b73c3346932","https://github.com/advisories/GHSA-x3r6-ccvq-cf5v"],"published_at":"2024-07-22T15:32:41Z","updated_at":"2024-07-26T16:13:59Z","github_reviewed_at":"2024-07-25T14:45:15Z","nvd_published_at":"2024-07-22T15:15:02Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"pip","name":"anki"},"vulnerable_version_range":"< 24.6","first_patched_version":"24.6","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N","score":5.3},"cwes":[{"cwe_id":"CWE-829","name":"Inclusion of Functionality from Untrusted Control Sphere"}],"credits":[{"user":{"login":"Jayy001","id":56607897,"node_id":"MDQ6VXNlcjU2NjA3ODk3","avatar_url":"https://avatars.githubusercontent.com/u/56607897?v=4","gravatar_id":"","url":"https://api.github.com/users/Jayy001","html_url":"https://github.com/Jayy001","followers_url":"https://api.github.com/users/Jayy001/followers","following_url":"https://api.github.com/users/Jayy001/following{/other_user}","gists_url":"https://api.github.com/users/Jayy001/gists{/gist_id}","starred_url":"https://api.github.com/users/Jayy001/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jayy001/subscriptions","organizations_url":"https://api.github.com/users/Jayy001/orgs","repos_url":"https://api.github.com/users/Jayy001/repos","events_url":"https://api.github.com/users/Jayy001/events{/privacy}","received_events_url":"https://api.github.com/users/Jayy001/received_events","type":"User","site_admin":false},"type":"analyst"}]},{"ghsa_id":"GHSA-mmwx-rj87-vfgr","cve_id":null,"url":"https://api.github.com/advisories/GHSA-mmwx-rj87-vfgr","html_url":"https://github.com/advisories/GHSA-mmwx-rj87-vfgr","summary":"DNSJava affected by KeyTrap - NSEC3 closest encloser proof can exhaust CPU resources","description":"### Impact\nUsers using the `ValidatingResolver` for DNSSEC validation can run into CPU exhaustion with specially crafted DNSSEC-signed zones.\n\n### Patches\nUsers should upgrade to dnsjava v3.6.0\n\n### Workarounds\nAlthough not recommended, only using a non-validating resolver, will remove the vulnerability.\n\n### References\nhttps://www.athene-center.de/en/keytrap\n","type":"reviewed","severity":"medium","repository_advisory_url":"https://api.github.com/repos/dnsjava/dnsjava/security-advisories/GHSA-mmwx-rj87-vfgr","source_code_location":"https://github.com/dnsjava/dnsjava","identifiers":[{"value":"GHSA-mmwx-rj87-vfgr","type":"GHSA"}],"references":["https://github.com/dnsjava/dnsjava/security/advisories/GHSA-mmwx-rj87-vfgr","https://github.com/dnsjava/dnsjava/commit/711af79be3214f52daa5c846b95766dc0a075116","https://github.com/advisories/GHSA-mmwx-rj87-vfgr"],"published_at":"2024-07-22T14:46:59Z","updated_at":"2024-07-22T15:30:56Z","github_reviewed_at":"2024-07-22T14:46:59Z","nvd_published_at":null,"withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"maven","name":"dnsjava:dnsjava"},"vulnerable_version_range":"< 3.6.0","first_patched_version":"3.6.0","vulnerable_functions":[]}],"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H","score":6.5},"cwes":[{"cwe_id":"CWE-400","name":"Uncontrolled Resource Consumption"}],"credits":[]}
    ]    
    """.trimIndent()

    val advisories = json.decodeFromString<Array<GitHubAdvisory>>(str)
    publish(advisories)
//    println(advisories[0])



    // create Producer properties
//    extract()
}

fun publish(advisories: Array<GitHubAdvisory>): Boolean {
    val bootstrapServers = "127.0.0.1:9092"
    val properties = Properties()
    properties.setProperty(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, bootstrapServers)
    properties.setProperty(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer::class.java.getName())
    properties.setProperty(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer::class.java.getName())
    val producer = KafkaProducer<String, String>(properties)

    advisories.forEach {
        producer.send(
            ProducerRecord(
                "advisories", it.ghsa_id,
                if (it.withdrawn_at == null) {
                    null
                } else {
                    json.encodeToString<GitHubAdvisory>(it)
                }
            )
        )
        println("published ${it.ghsa_id}")
    }
    producer.flush()
    return true //TODO: remove?
}

private val json = Json { ignoreUnknownKeys = true; coerceInputValues = true }

fun extract(since: Date, processor: (Array<GitHubAdvisory>) -> Boolean) {
    val client = OkHttpClient();

    val format = SimpleDateFormat(">YYYY-MM-DDTHH:MM:SSZ")
    val request = Request.Builder()
        .url("https://api.github.com/advisories")
        .header("X-GitHub-Api-Version", "2022-11-28")
        .header("Authorization", "Bearer $token")
        .header("published", format.format(since))
        .header("Accept", "application/vnd.github+json")
        .build()

    client.newCall(request).execute().use { response ->
        if (!response.isSuccessful) throw IOException("Unexpected code $response")

        for ((name, value) in response.headers) {
            println("$name: $value")
        }

        val advisories = json.decodeFromString<Array<GitHubAdvisory>>(response.body!!.string())
        processor(advisories)
//
//        println(response.body!!.string())
    }
}